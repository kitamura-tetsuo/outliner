	// items プロパティの型を明示的に定義（Fluid Framework による型推論が unknown となるのを防ぐが、Uncaught TypeError TypeError: 'ownKeys' on proxy: trap returned duplicate entries のエラーが出る。
	// public readonly items!: typeof Items;


checkTypes.ts の使い方
型チェックを実行する：

このコマンドは、ファイルをコンパイルせずに型チェックだけを実行します。エラーメッセージがある場合は、それが存在しない型や間違った使い方を示しています。

ViewableTree の存在を確認する：

ファイル内の以下のセクションのコメントを外して型チェックを実行します：

エラーが出る場合は、ViewableTree が型としてエクスポートされていないことを意味します。

SharedTree の機能を確認する：

ファイル内の checkSharedTreeMethods 関数は、SharedTree クラスが viewWith メソッドなど、必要な機能を持っているかを確認します。これもまた型チェックによって検証されます。

実行時ロードパターンのテスト：

ファイル内の testValidImportPatterns 関数は、ESM と CommonJS の両方の環境で機能するインポートパターンを示しています。特に SSR 環境で安全に動作するパターンも含まれています。

SSR 互換の import パターン
このファイルから学べる重要なことの一つは、SSR 環境でも安全に動作するインポートパターンです：

このパターンは、モジュールが特定のエクスポートを持っているかを実行時にチェックしてから使用するため、SSR の型の不一致問題を回避できます。

実装への適用方法
この情報を使って以下のように実装を改善できます：

ViewableTree が存在しない場合は、先日修正したように、SharedTree として型キャストしてから viewWith メソッドを使用します。

SSR 環境で特定の処理を条件分岐する場合：

このファイルは直接アプリケーションの機能として使用するものではなく、Fluid Framework のインターフェースを理解し、SSR 環境でも正しく動作するようなコードを書くためのガイドとして役立ちます。SSR での型の問題を解決する際の参考として活用できます。



cd /workspace/client
npx tsc src/debug/checkTypes.ts --noEmit


cd /workspace/server && npm run create-test-user




ローカル環境で CI環境を再現してテストを行うには。
.env を全て a.env等にリネームする。
	Vite 辺りが自動的に .envを読み込むので、リネームして対象から外す。
	CI環境には .envはない。環境変数は全て yamlから設定される。
.gitlab-ci.yml
	から先頭の 
	image: mcr.microsoft.com/playwright:v1.51.0-noble
		をコメントアウトする。
	コメントアウトすることで、docker内での実行から、その場の bashでの実行に変わる。
	デバッグするなら bashの方が楽なので。
.gitlab-ci.yml
	から 
  script:
		で
    - 'npm run ci:test:e2e:ui'
		を実行するように変える。
    - 'npm run ci:test:e2e:xvfb'
		はコメントアウトする。
npx gitlab-ci-local
	を実行する


DOMから検索するにはデバッグコンソールで下記
document.querySelectorAll('.cursor')


git 全バージョンの全文検索
git grep -n "updateFluidClient" $(git rev-list --all) -- . ':(exclude)*.md'


./mutagen sync monitor
./mutagen sync list --long
./mutagen sync terminate
./mutagen sync create --ignore-vcs --ignore node_modules/**,client/node_modules**,server/node_modules**,.venv/**,client/.svelte-kit/**,client/playwright-report/**,client/logs/**,client/e2e/logs/**,server/logs/** C:\Users\kitam\src\outliner ubuntu@192.168.50.13:~/src/outliner

