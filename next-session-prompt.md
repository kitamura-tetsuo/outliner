# 次のセッション用プロンプト

## 現在の状況

### 実装済み機能

- **NAV-0002: プロジェクトページへのリンク機能**を実装済み
  - `client/src/routes/[project]/[page]/+page.svelte`にパンくずナビゲーションを追加
  - ホーム → プロジェクト → ページ の階層ナビゲーション
  - プロジェクトページへのリンク機能（`goToProject()`関数）
  - `docs/client-features.yaml`に機能仕様を追加済み

### 作成済みファイル

- `client/e2e/core/NAV-0002.spec.ts` - テストファイル作成済み

## 解決が必要な課題

### 1. テスト実行の問題

**現状**: E2Eテストが`page.goto`でタイムアウトエラーが発生

- エラー: `page.goto: net::ERR_ABORTED; maybe frame was detached?`
- `TestHelpers.prepareTestEnvironment`での初期化に問題

**対応が必要**:

1. テスト環境の接続問題を解決
2. `TestHelpers.prepareTestEnvironment`の修正または代替手段
3. NAV-0002テストの実行と検証

### 2. テストファイルの修正

**現状**: テストファイルは作成済みだが実行できない状態

**対応が必要**:

1. テスト環境の安定化
2. テストの実行と結果確認
3. 必要に応じてテストケースの調整

## 次のセッションでの作業手順

### 順次作業を進める方針

各テストファイルを一つずつ修正し、修正後は必ずテストを実行して確認してください。

### 1. NAV-0002テストの修正と実行

```bash
cd client && npx playwright test NAV-0002.spec.ts --project=core
```

### 2. テスト環境の問題解決

- サーバー接続の確認: `curl http://localhost:7090/`
- サーバーログの確認: `server/logs/test-svelte-kit.log`
- 必要に応じて`TestHelpers.prepareTestEnvironment`の修正

### 3. テスト結果の検証

- 全7つのテストケースが正常に実行されることを確認
- 失敗したテストがあれば実装を修正（テストを実装に合わせない）

### 4. 他のテストファイルの修正

NAV-0002が完了後、他の失敗しているテストファイルを順次修正

## 重要な注意事項

### テスト修正の原則

- **テストの期待値が仕様に一致しているかを最初に確認**
- テストの期待値が正しい場合は実装を修正
- テストを実装に合わせることは禁止

### E2Eテストの実行

- headlessモードで実行
- テストサーバーが起動していない場合は環境整備を行う
- 動かない原因が不明な場合はPlaywright MCPで確認

### 実装の確認

現在の実装内容:

- パンくずナビゲーション（ホーム / プロジェクト / ページ）
- プロジェクトページへのリンク機能
- 適切なスタイリング（Tailwind CSS）

## 期待される成果

1. NAV-0002テストが全て成功すること
2. プロジェクトページへのリンク機能が正常に動作すること
3. テスト環境の安定化

## 次のセッション開始時のコマンド

```bash
# テスト実行
cd client && npx playwright test NAV-0002.spec.ts --project=core

# サーバー状態確認（必要に応じて）
curl http://localhost:7090/
```
