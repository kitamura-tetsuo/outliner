- id: FTR-0012
  title: User can reset forgotten password
  status: implemented # draft / implemented / deprecated
  components:
    - routes/auth/forgot.svelte
    - lib/email/resetPassword.ts
  tests:
    - tests/feature/FTR-0012.spec.ts
  acceptance:
    - 'ユーザーがメールアドレスを入力すると、リセットリンクが送信される'
    - 'リンクは 30 分で失効する'
    - '正しいトークンを送るとパスワードを再設定できる'
- id: IME-0001
  title: IMEを使用した日本語入力
  status: implemented # draft / implemented / deprecated
  tests:
    - client/e2e/core/IME-0001.spec.ts
  acceptance:
    - 'IMEを使用した日本語入力が可能になる'
    - '入力途中の文字がカーソル位置に表示される'
    - '変換候補がカーソル位置に表示される'
- id: CLM-0001
  title: 'クリックで編集モードに入る'
  shortcut: 'クリック'
  description: 'クリックで編集モードに入ります。'
  category: cursor-movement
  status: implemented
  tests:
    - client/e2e/core/CLM-0001.spec.ts
  acceptance:
    - 'クリックで編集モードに入る'
    - '編集モードで文字入力が可能になる'
    - 'カーソルが表示される'
    - 'カーソルがクリック位置に表示される（最後の行を除く）'
    - 'カーソルが点滅する'
- id: CLM-0002
  title: '左へ移動'
  shortcut: '←'
  description: 'カーソルを1文字左に移動します。'
  category: cursor-movement
  status: implemented
  acceptance:
    - 'カーソルを1文字左に移動する'
    - '一番最初の文字にある時は、一つ前のアイテムの最後の文字へ移動する'
  tests:
    - client/e2e/core/CLM-0002.spec.ts
- id: CLM-0003
  title: '右へ移動'
  shortcut: '→'
  description: 'カーソルを1文字右に移動します。'
  category: cursor-movement
  status: implemented
  acceptance:
    - 'カーソルを1文字右に移動する'
    - '一番最後の文字にある時は、一つ次のアイテムの最初の文字へ移動する'
  tests:
    - client/e2e/core/CLM-0003.spec.ts
- id: CLM-0004
  title: '上へ移動'
  shortcut: '↑'
  description: 'カーソルを1行上に移動します。'
  category: cursor-movement
  status: implemented
  acceptance:
    - 'カーソルを1行上に移動する'
    - '一番上の行以外にある時は、同じアイテムの1行上へ移動する'
    - '一番上の行にある時は、一つ前のアイテムの最後の行へ移動する。このとき、x座標の変化が最も小さい位置にカーソルをセットする。文字数が少ない場合は大きく移動する場合もある。カーソル上下以外の操作をしていない場合は、最初にカーソル上を押し始めた x座標からの変化が小さい位置にカーソルをセットする。'
    - '一番上の行にある時で、一つ前のアイテムがない時は、同じアイテムの先頭へ移動する'
  tests:
    - client/e2e/core/CLM-0004.spec.ts
- id: CLM-0005
  title: '下へ移動'
  shortcut: '↓'
  description: 'カーソルを1行下に移動します。'
  category: cursor-movement
  status: implemented
  acceptance:
    - 'カーソルを1行下に移動する'
    - '一番下の行以外にある時は、同じアイテムの1行下へ移動する'
    - '一番下の行にある時は、一つ次のアイテムの最初の行へ移動する。このとき、x座標の変化が最も小さい位置にカーソルをセットする。文字数が少ない場合は大きく移動する場合もある。カーソル上下以外の操作をしていない場合は、最初にカーソル下を押し始めた x座標からの変化が小さい位置にカーソルをセットする。'
    - '一番下の行にある時で、一つ次のアイテムがない時は、同じアイテムの末尾へ移動する'
  tests:
    - client/e2e/core/CLM-0005.spec.ts
- id: CLM-0007
  title: '行頭へ移動'
  shortcut: 'Home'
  description: 'カーソルを行の先頭に移動します。'
  category: cursor-movement
  status: implemented # draft / implemented / deprecated
  acceptance:
    - 'Homeキーを押すと、カーソルが現在の行の先頭に移動する'
    - '複数行のアイテムでは、現在のカーソルがある行の先頭に移動する'
  tests:
    - client/e2e/core/CLM-0007.spec.ts
- id: CLM-0008
  title: '行末へ移動'
  shortcut: 'End'
  description: 'カーソルを行の末尾に移動します。'
  category: cursor-movement
  status: implemented # draft / implemented / deprecated
  acceptance:
    - 'Endキーを押すと、カーソルが現在の行の末尾に移動する'
    - '複数行のアイテムでは、現在のカーソルがある行の末尾に移動する'
  tests:
    - client/e2e/core/CLM-0008.spec.ts
- id: CLM-0100
  title: '通常クリックでカーソルが増えないこと'
  description: 'アイテム間を移動する際に、カーソルが増えないようにします。'
  category: cursor-management
  status: implemented
  tests:
    - client/e2e/core/CLM-0100.spec.ts
  acceptance:
    - 'アイテム間をクリックで移動しても、カーソルの数が増えない'
    - '常に1つのカーソルだけが表示される'
    - '前のアイテムのカーソルは完全に削除される'
- id: CLM-0101
  title: 'アイテム間移動時のカーソル重複と入力分散問題'
  description: 'アイテム間を移動する際に、複数のカーソルが生成され、入力が複数のアイテムに分散する問題を検出します。'
  category: cursor-management
  status: implemented
  tests:
    - client/e2e/core/CLM-0101.spec.ts
  acceptance:
    - '複数のアイテムをクリックすると、複数のカーソルが生成される問題を検出する'
    - '入力が複数のアイテムに分散する問題を検出する'
    - '1番目のアイテムに「123」の繰り返しが表示される問題を検出する'
    - '異なる位置に複数のカーソルが表示される問題を検出する'
- id: CLM-0102
  title: '空のテキストアイテムでのカーソル移動と複数回のキーボード操作'
  description: '空のテキストアイテムでのカーソル移動と、クリック後の複数回のキーボード操作が正しく機能することを確認します。'
  category: cursor-management
  status: implemented
  tests:
    - client/e2e/core/CLM-0102.spec.ts
  acceptance:
    - '空のテキストアイテム間をキーボードで移動できる'
    - 'クリック後に複数回のキーボード操作でカーソルが正しく移動する'
    - 'アイテム間を移動しても常に1つのカーソルだけが表示される'
    - '入力が正しいアイテムに行われる'
- id: CLM-0103
  title: 'フォーマット文字列でのカーソル操作'
  description: 'フォーマット（太字、斜体など）が適用された文字列内でのカーソル移動が正しく機能することを確認します。'
  category: cursor-movement
  status: implemented
  tests:
    - client/e2e/core/CLM-0103.spec.ts
  acceptance:
    - 'フォーマット文字列内でのカーソル移動が正しく機能する'
    - '複数のフォーマットが混在する文字列でのカーソル移動が正しく機能する'
    - 'Home/Endキーがフォーマット文字列で正しく機能する'
    - 'Shift+矢印キーによる選択がフォーマット文字列で正しく機能する'
- id: SLR-0001
  title: 'Shift + 上下左右'
  shortcut: 'Shift + 上下左右'
  description: 'カーソルを1文字上下左右に移動し、選択範囲を広げます。'
  category: selection-range
  status: implemented
  acceptance:
    - 'Shift + 上で選択範囲の上端を広げる'
    - 'Shift + 下で選択範囲の下端を広げる'
    - 'Shift + 左で選択範囲の左端を広げる'
    - 'Shift + 右で選択範囲の右端を広げる'
  tests:
    - client/e2e/core/SLR-0001.spec.ts
- id: SLR-0002
  title: '行頭まで選択'
  shortcut: 'Shift + Home'
  description: 'カーソル位置から行の先頭までを選択します。'
  category: selection-range
  status: implemented
  acceptance:
    - 'Shift + Homeで現在位置から行頭までを選択する'
    - '複数行のアイテムでは、現在のカーソルがある行の先頭までを選択する'
  tests:
    - client/e2e/core/SLR-0002.spec.ts
- id: SLR-0003
  title: '行末まで選択'
  shortcut: 'Shift + End'
  description: 'カーソル位置から行の末尾までを選択します。'
  category: selection-range
  status: implemented
  acceptance:
    - 'Shift + Endで現在位置から行末までを選択する'
    - '複数行のアイテムでは、現在のカーソルがある行の末尾までを選択する'
  tests:
    - client/e2e/core/SLR-0003.spec.ts
- id: SLR-0004
  title: 'マウスドラッグによる選択'
  description: 'マウスドラッグでテキストを選択します。'
  category: selection-range
  status: implemented
  acceptance:
    - 'マウスドラッグで単一アイテム内のテキストを選択できる'
    - '選択範囲が視覚的に表示される'
    - '選択範囲のテキストをコピーできる'
  tests:
    - client/e2e/core/SLR-0004.spec.ts
- id: SLR-0005
  title: '複数アイテムにまたがる選択'
  description: '複数アイテムにまたがるテキスト選択機能'
  category: selection-range
  status: implemented
  acceptance:
    - 'Shift+上下キーで複数アイテムにまたがる選択範囲を作成できる'
    - 'マウスドラッグで複数アイテムにまたがる選択範囲を作成できる'
    - '複数アイテムにまたがる選択範囲が視覚的に表示される'
  tests:
    - client/e2e/core/SLR-0005.spec.ts
- id: SLR-0006
  title: '複数アイテム選択範囲のコピー＆ペースト'
  description: '複数アイテムにまたがる選択範囲のコピー＆ペースト機能'
  category: selection-range
  status: implemented
  acceptance:
    - '複数アイテムにまたがる選択範囲のテキストをコピーできる'
    - 'コピーしたテキストを別の場所にペーストできる'
    - '複数行テキストをペーストすると適切に複数アイテムに分割される'
  tests:
    - client/e2e/core/SLR-0006.spec.ts
- id: SLR-0007
  title: '複数アイテム選択範囲の削除'
  description: '複数アイテムにまたがる選択範囲の削除機能'
  category: selection-range
  status: implemented
  acceptance:
    - '複数アイテムにまたがる選択範囲をBackspace/Deleteキーで削除できる'
    - '削除後、アイテムが適切に結合される'
    - 'カーソル位置が適切に更新される'
  tests:
    - client/e2e/core/SLR-0007.spec.ts
- id: SLR-0008
  title: '選択範囲のエッジケース'
  description: '選択範囲機能のエッジケースのテスト'
  category: selection-range
  status: implemented
  acceptance:
    - '空のアイテムを含む選択範囲を作成できる'
    - '長いテキストを含むアイテムの選択範囲を作成できる'
    - '選択範囲の方向（正方向/逆方向）を切り替えることができる'
    - '複数アイテムにまたがる選択範囲を削除した後、カーソル位置が適切に更新される'
  tests:
    - client/e2e/core/SLR-0008.spec.ts
- id: SLR-0009
  title: 'ドラッグ＆ドロップによるテキスト移動'
  description: '選択範囲のテキストをドラッグ＆ドロップで移動する機能'
  category: selection-range
  status: implemented
  acceptance:
    - '単一アイテム内の選択範囲をドラッグ＆ドロップで移動できる'
    - '複数アイテムにまたがる選択範囲をドラッグ＆ドロップで移動できる'
    - 'アイテム全体をドラッグ＆ドロップで移動できる'
    - 'ドラッグ中に視覚的なフィードバックが表示される'
    - 'ドロップ位置に応じて適切にテキストが挿入される'
  tests:
    - client/e2e/core/SLR-0009.spec.ts
- id: SLR-0010
  title: '選択範囲のフォーマット変更'
  description: '選択範囲のテキストのフォーマット（太字、斜体、下線、取り消し線、コード）を変更する機能'
  category: selection-range
  status: implemented
  acceptance:
    - '単一アイテム内の選択範囲のフォーマットを変更できる'
    - '複数アイテムにまたがる選択範囲のフォーマットを変更できる'
    - 'Scrapbox構文に準拠したフォーマットが適用される'
    - 'キーボードショートカットでフォーマットを変更できる'
    - '太字フォーマット（[[text]]）を適用できる'
    - '斜体フォーマット（[/ text]）を適用できる'
    - '取り消し線フォーマット（[- text]）を適用できる'
    - 'コードフォーマット（`text`）を適用できる'
    - '同じフォーマットを再度適用すると、フォーマットが解除される'
  tests:
    - client/e2e/core/SLR-0010.spec.ts
- id: SLR-0100
  title: 'ボックス選択（矩形選択）機能 - キーボード'
  shortcut: 'Alt+Shift+矢印キー'
  description: 'Alt+Shift+矢印キーによる矩形選択機能'
  category: selection-range
  status: implemented
  acceptance:
    - 'Alt+Shift+矢印キーで矩形選択を開始できる'
    - '矩形選択の範囲を矢印キーで拡張できる'
    - '矩形選択の範囲が視覚的に表示される'
    - '複数アイテムにまたがる矩形選択を作成できる'
    - 'Escキーで矩形選択をキャンセルできる'
    - '矩形選択範囲のテキストをコピーできる'
    - '矩形選択範囲にテキストをペーストできる'
  tests:
    - client/e2e/core/SLR-0100.spec.ts

- id: SLR-0101
  title: 'ボックス選択（矩形選択）機能 - マウス'
  shortcut: 'Alt+Shift+ドラッグ'
  description: 'Alt+Shift+マウスドラッグによる矩形選択機能'
  category: selection-range
  status: implemented
  acceptance:
    - 'Alt+Shift+マウスドラッグで矩形選択を開始できる'
    - '矩形選択の範囲がドラッグに合わせて拡張される'
    - '矩形選択の範囲が視覚的に表示される'
    - '複数アイテムにまたがる矩形選択を作成できる'
    - '矩形選択範囲のテキストをコピーできる'
    - '矩形選択範囲にテキストをペーストできる'
    - '矩形選択範囲のテキストを削除できる'
  tests:
    - client/e2e/core/SLR-0101.spec.ts
- id: FMT-0001
  title: 'フォーマット表示'
  description: 'Scrapbox構文のフォーマットを視覚的に表示する機能'
  category: text-formatting
  status: implemented
  acceptance:
    - 'カーソルがないアイテムではフォーマットされた内容が表示される'
    - 'カーソルがあるアイテムではプレーンテキストの入力内容がそのまま表示される'
    - '太字フォーマット（[[text]]）が視覚的に太字で表示される'
    - '斜体フォーマット（[/ text]）が視覚的に斜体で表示される'
    - '取り消し線フォーマット（[- text]）が視覚的に取り消し線付きで表示される'
    - 'コードフォーマット（`text`）が視覚的にコードスタイルで表示される'
    - 'Scrapbox構文のUXをクローンし、編集中はプレーンテキスト、非編集時はフォーマット表示となる'
  tests:
    - client/e2e/core/FMT-0001.spec.ts
- id: FMT-0002
  title: 'フォーマット組み合わせ'
  description: 'Scrapbox構文の複数フォーマットの組み合わせを視覚的に表示する機能'
  category: text-formatting
  status: implemented
  acceptance:
    - '太字と斜体の組み合わせが正しく表示される'
    - '太字と取り消し線の組み合わせが正しく表示される'
    - '斜体とコードの組み合わせが正しく表示される'
    - '複数のフォーマットが入れ子になっている場合も正しく表示される'
    - 'カーソルがあるアイテムでは組み合わせフォーマットもプレーンテキストで表示される'
  tests:
    - client/e2e/core/FMT-0002.spec.ts
- id: FMT-0003
  title: '拡張フォーマット'
  description: 'Scrapbox構文の拡張フォーマット（リンク、引用）を視覚的に表示する機能'
  category: text-formatting
  status: implemented
  acceptance:
    - 'リンク構文（[URL]）が正しくリンクとして表示される'
    - '引用構文（> テキスト）が正しく引用として表示される'
    - '複合フォーマット（引用内の太字や斜体など）が正しく表示される'
    - 'カーソルがあるアイテムでは拡張フォーマットもプレーンテキストで表示される'
  tests:
    - client/e2e/core/FMT-0003.spec.ts
- id: FMT-0004
  title: 'クリップボードからのペーストとフォーマット'
  description: 'クリップボードからのテキストペーストとフォーマット保持機能'
  category: text-formatting
  status: implemented
  acceptance:
    - 'プレーンテキストのペーストが正しく機能する'
    - 'フォーマット構文を含むテキストのペーストが正しく機能する'
    - '複数行テキストのペーストが正しく機能する'
    - 'カーソル位置にテキストがペーストされる'
    - 'ペーストされたフォーマット構文が視覚的に正しく表示される'
  tests:
    - client/e2e/core/FMT-0004.spec.ts

- id: FMT-0005
  title: 'Visual Studio Codeのコピー/ペースト仕様'
  description: 'Visual Studio Codeのコピー/ペースト仕様に準拠したクリップボード操作'
  category: text-formatting
  status: implemented
  acceptance:
    - 'シングルカーソル（通常選択）からシングルカーソルへのペーストが正しく機能する'
    - 'シングルカーソル（通常選択）からマルチカーソルへのペースト（spread設定）が正しく機能する'
    - 'シングルカーソル（通常選択）からマルチカーソルへのペースト（full設定）が正しく機能する'
    - 'マルチカーソル（複数選択範囲）からシングルカーソルへのペーストが正しく機能する'
    - 'マルチカーソル（複数選択範囲）からマルチカーソルへのペースト（spread設定）が正しく機能する'
    - 'マルチカーソル（複数選択範囲）からマルチカーソルへのペースト（full設定）が正しく機能する'
    - 'ボックス選択（矩形選択）からのペーストが正しく機能する'
    - 'ボックス選択（矩形選択）へのペーストが正しく機能する'
    - '複数行テキストをボックス選択（矩形選択）範囲にペーストすると、各行に対応する行が挿入される'
    - 'ボックス選択（矩形選択）範囲へのペースト時に、選択範囲が適切に置き換えられる'
  tests:
    - client/e2e/core/FMT-0005.spec.ts

- id: FMT-0006
  title: 'カーソル移動時のフォーマット表示の一貫性'
  description: 'カーソル移動時にフォーマット表示が一貫して適切に切り替わることを確認します'
  category: text-formatting
  status: implemented
  acceptance:
    - 'カーソルがあるアイテムでは制御文字（[[]], [/], [-], `）が表示される'
    - 'カーソルがないアイテムでは制御文字が非表示でフォーマットが適用される'
    - 'タイトル（最初の行）は常にボールド表示される'
    - 'リンク構文（[ text]]）が正しくリンクとして表示される'
    - 'カーソル移動時に表示が適切に切り替わる'
  tests:
    - client/e2e/core/FMT-0006.spec.ts

- id: FMT-0007
  title: '内部リンク機能の表示'
  description: '/project-name/page-name 形式の内部リンクをサポートする機能'
  category: text-formatting
  status: implemented
  acceptance:
    - '[page-name] 形式の内部リンクが正しく表示される'
    - '[/project-name/page-name] 形式の内部リンクが正しく表示される'
    - 'カーソルがあるアイテムでは内部リンクもプレーンテキストで表示される'
    - 'カーソルがないアイテムでは内部リンクが視覚的にリンクとして表示される'
  tests:
    - client/e2e/core/FMT-0007.spec.ts

- id: LNK-0001
  title: '内部リンクのURL生成機能'
  description: '内部リンクのURLが正しく生成される機能'
  category: navigation
  status: implemented
  acceptance:
    - '内部リンクのURLが正しく生成される'
    - '内部リンクのHTMLが正しく生成される'
    - '[page-name] 形式の内部リンクが /page-name のURLを生成する'
    - '[/project-name/page-name] 形式の内部リンクが /project-name/page-name のURLを生成する'
  tests:
    - client/e2e/core/LNK-0001.spec.ts

- id: LNK-0002
  title: '内部リンクの機能検証'
  description: '内部リンクが正しく機能することを確認する'
  category: navigation
  status: implemented
  acceptance:
    - '内部リンクのhref属性が正しく生成される'
    - 'プロジェクト内部リンク（/project-name/page-name形式）のhref属性が正しく生成される'
    - '内部リンクのクラスとテキストが正しく設定される'
    - '様々な形式の内部リンクが正しく生成される'
  tests:
    - client/e2e/core/LNK-0002.spec.ts

- id: LNK-0003
  title: '内部リンクのナビゲーション機能'
  description: '内部リンクをクリックして別のページに移動する機能'
  category: navigation
  status: implemented
  acceptance:
    - '内部リンクをクリックすると対応するページに移動する'
    - 'プロジェクト内部リンク（/project-name/page-name形式）をクリックすると対応するページに移動する'
    - 'URLを直接入力して内部リンク先のページにアクセスできる'
    - '存在しないページへのリンクをクリックした場合も対応するURLに移動する'
    - '内部リンクの形式が正しく生成される（[page-name]形式）'
    - 'プロジェクト内部リンクの形式が正しく生成される（[/project-name/page-name]形式）'
    - '内部リンクをクリックして遷移先のページ内容が正しく表示される'
    - '存在しないページへの内部リンクをクリックした場合、新規ページが作成される'
    - 'プロジェクト内部リンクをクリックして遷移先のページ内容が正しく表示される'
  tests:
    - client/e2e/core/LNK-0003.spec.ts
  testcases:
    - '内部リンクをクリックして別のページに移動する'
    - 'URLを直接入力して内部リンク先のページにアクセスする'
    - '実際のアプリケーションで内部リンクを作成する'
    - '実際のアプリケーションでプロジェクト内部リンクを作成する'
    - '内部リンクをクリックして遷移先のページ内容が正しく表示される'
    - '存在しないページへの内部リンクをクリックした場合の挙動'
    - 'プロジェクト内部リンクをクリックして遷移先のページ内容が正しく表示される'

- id: LNK-0004
  title: '仮ページ機能'
  description: '存在しないページへのリンクをクリックした場合に仮ページを表示し、編集時のみ実際のページとして保存する機能'
  category: navigation
  status: implemented
  acceptance:
    - '存在しないページへのリンクをクリックした場合、仮ページを表示する'
    - '仮ページであることを示すUIが表示される'
    - '仮ページを編集した場合のみ、実際のページとして保存される'
    - '仮ページにアクセスしただけでは、ページは作成されない'
    - '仮ページが保存された後は、通常のページとして扱われる'
    - '仮ページの通知UIが多言語対応している'
    - '仮ページの通知UIにアクションボタン（作成/キャンセル）が表示される'
  tests:
    - client/e2e/core/LNK-0004.spec.ts
  testcases:
    - '存在しないページへのリンクをクリックした場合に仮ページが表示される'
    - '仮ページを編集した場合に実際のページとして保存される'
    - '仮ページにアクセスしただけではページが作成されないことを確認'
    - '仮ページの通知UIが正しく表示される'
    - '仮ページの通知UIのアクションボタンが機能する'

- id: LNK-0005
  title: 'リンクプレビュー機能'
  description: '内部リンクにマウスオーバーした際にページ内容のプレビューを表示する機能'
  category: navigation
  status: implemented
  acceptance:
    - '内部リンクにマウスオーバーするとプレビューが表示される'
    - 'プレビューにはページのタイトルと内容の一部が表示される'
    - 'プレビューはマウスが離れると非表示になる'
    - '存在しないページへのリンクの場合は、その旨が表示される'
    - '別プロジェクトのページへのリンクの場合は、その旨が表示される'
  tests:
    - client/e2e/core/LNK-0005.spec.ts
  testcases:
    - '内部リンクにマウスオーバーするとプレビューが表示される'
    - 'プレビューにページのタイトルと内容の一部が表示される'
    - 'プレビューはマウスが離れると非表示になる'
    - '存在しないページへのリンクの場合は、その旨が表示される'
  notes:
    - 'テスト環境ではマウスイベントが正確に動作しない場合があるため、TestHelpers.forceHoverEvent()とTestHelpers.forceLinkPreview()を使用してテストを安定化'

- id: LNK-0006
  title: 'リンク先ページの存在確認機能'
  description: '内部リンクのリンク先ページが存在するかどうかを視覚的に区別する機能'
  category: navigation
  status: implemented
  acceptance:
    - '存在するページへのリンクと存在しないページへのリンクが視覚的に区別される'
    - '存在しないページへのリンクは点線下線や異なる色で表示される'
    - 'リンク先ページの存在確認は動的に更新される'
  tests:
    - client/e2e/core/LNK-0006.spec.ts
  testcases:
    - '存在するページへのリンクと存在しないページへのリンクが視覚的に区別される'
    - '存在しないページへのリンクは点線下線や異なる色で表示される'
    - 'ページが作成されると、リンクの表示が更新される'

- id: LNK-0007
  title: 'バックリンク機能'
  description: 'あるページからリンクされているページの一覧を表示する機能'
  category: navigation
  status: implemented
  acceptance:
    - 'ページにバックリンクパネルが表示される'
    - 'バックリンクパネルには、そのページへのリンクを含むページの一覧が表示される'
    - 'バックリンクの数がバッジとして表示される'
    - 'バックリンクパネルは開閉できる'
    - 'バックリンクをクリックすると、リンク元のページに移動できる'
    - 'バックリンクのコンテキスト（リンクを含む文脈）が表示される'
  tests:
    - client/e2e/core/LNK-0007.spec.ts
  testcases:
    - 'ページにバックリンクパネルが表示される'
    - 'バックリンクパネルにリンク元ページの一覧が表示される'
    - 'バックリンクの数がバッジとして表示される'
    - 'バックリンクパネルを開閉できる'
    - 'バックリンクをクリックするとリンク元ページに移動できる'
  notes:
    - 'テスト環境ではバックリンクパネルの開閉が正確に動作しない場合があるため、TestHelpers.openBacklinkPanel()を使用してテストを安定化'

- id: TST-0001
  title: 'SharedTreeデータ検証ユーティリティ'
  description: 'テストにおいてSharedTreeの内容をJSONとして取得し、結果を厳密かつ簡易に判定するユーティリティ'
  category: testing
  status: implemented
  acceptance:
    - 'SharedTreeのデータ構造をJSON形式で取得できる'
    - '期待値と実際の値を厳密に比較できる'
    - '期待値と実際の値を部分的に比較できる'
    - '特定のパスのデータを検証できる'
    - 'スナップショットを取得して後で比較できる'
    - '特定のパスを無視して比較できる'
    - 'ネストされた構造（親子関係）を正確に検証できる'
  tests:
    - client/e2e/utils/tree-validation.spec.ts
  examples:
    - client/e2e/utils/tree-validator-examples.ts
    - client/e2e/utils/tree-validator-usage.md

- id: TST-0002
  title: 'カーソル情報検証ユーティリティ'
  description: 'テストにおいてカーソル情報をJSONとして取得し、結果を厳密かつ簡易に判定するユーティリティ'
  category: testing
  status: implemented
  acceptance:
    - 'カーソル情報をJSON形式で取得できる'
    - '期待値と実際の値を厳密に比較できる'
    - '期待値と実際の値を部分的に比較できる'
    - '特定のパスのデータを検証できる'
    - 'スナップショットを取得して後で比較できる'
    - 'カーソルの数を検証できる'
    - 'アクティブなアイテムIDを検証できる'
  tests:
    - client/e2e/utils/cursor-validation.spec.ts
  examples:
    - client/e2e/utils/cursor-validator-examples.ts
    - client/e2e/utils/cursor-validator-usage.md

- id: TST-0003
  title: 'テストヘルパーユーティリティ'
  description: 'テストにおいてカーソル状態の検証を容易にするヘルパー関数群'
  category: testing
  status: implemented
  acceptance:
    - 'カーソルデバッグ機能をセットアップできる（setupCursorDebugger）'
    - 'カーソルが表示されるまで待機できる（waitForCursorVisible）'
    - 'アクティブなアイテムIDを取得できる（getActiveItemId）'
    - 'アクティブなアイテム要素を取得できる（getActiveItemLocator）'
    - 'アイテムをクリックして編集モードに入れる（clickItemToEdit）'
    - 'class:editingセレクタの代わりにカーソル状態を検証できる'
    - 'マウスオーバーイベントを強制的にシミュレートできる（forceHoverEvent）'
    - 'マウスアウトイベントを強制的にシミュレートできる（forceMouseOutEvent）'
    - 'リンクプレビューを強制的に表示できる（forceLinkPreview）'
    - 'バックリンクパネルを開くことができる（openBacklinkPanel）'
    - 'DOM要素の可視性を強制的に確認できる（forceCheckVisibility）'
  tests:
    - client/e2e/core/CLM-0001.spec.ts
    - client/e2e/core/CLM-0002.spec.ts
    - client/e2e/core/CLM-0003.spec.ts
    - client/e2e/core/CLM-0004.spec.ts
    - client/e2e/core/CLM-0005.spec.ts
    - client/e2e/core/CLM-0007.spec.ts
    - client/e2e/core/CLM-0008.spec.ts
    - client/e2e/core/CLM-0100.spec.ts
    - client/e2e/core/CLM-0101.spec.ts
    - client/e2e/core/CLM-0103.spec.ts
    - client/e2e/core/SLR-0003.spec.ts
    - client/e2e/core/SLR-0004.spec.ts
    - client/e2e/core/SLR-0005.spec.ts
    - client/e2e/core/SLR-0010.spec.ts
    - client/e2e/core/FMT-0005.spec.ts
    - client/e2e/core/FMT-0006.spec.ts
    - client/e2e/core/IME-0001.spec.ts
    - client/e2e/core/ITM-0001.spec.ts
    - client/e2e/core/ITM-0001-title.spec.ts
    - client/e2e/core/add-text.spec.ts
    - client/e2e/core/tinylicious.spec.ts
    - client/e2e/auth/auth.spec.ts
  examples:
    - client/e2e/utils/testHelpers.ts

- id: ITM-0001
  title: 'Enterで新規アイテム追加'
  shortcut: 'Enter'
  description: 'カーソル位置でアイテムを分割し、新しいアイテムを追加します。'
  category: item-management
  status: implemented
  acceptance:
    - 'Enterキーを押すと、カーソル位置でアイテムが分割される'
    - 'カーソル位置より前のテキストは現在のアイテムに残る'
    - 'カーソル位置より後のテキストは新しいアイテムに移動する'
    - 'カーソルは新しいアイテムの先頭に移動する'
    - '通常のアイテムでは、新しいアイテムは兄弟として追加される'
    - 'タイトルでは、新しいアイテムは最初の子として追加される'
  tests:
    - client/e2e/core/ITM-0001.spec.ts
    - client/e2e/core/ITM-0001-title.spec.ts

- id: APP-0001
  title: '起動時にグローバルテキストエリアにフォーカスを設定'
  description: 'アプリケーション起動時に自動的にグローバルテキストエリアにフォーカスを設定し、すぐに入力できるようにします。'
  category: application
  status: implemented
  acceptance:
    - 'アプリケーション起動時にグローバルテキストエリアにフォーカスが設定される'
    - 'カーソルが表示される'
    - 'ユーザーがクリックせずに直接テキスト入力が可能になる'
  tests:
    - client/e2e/core/APP-0001.spec.ts

- id: TST-0004
  title: 'テスト環境の改善'
  description: 'テスト環境の安定性と信頼性を向上させるための改善'
  category: testing
  status: implemented
  acceptance:
    - 'テスト実行時のタイムアウト設定を延長し、テストの安定性を向上させる'
    - '要素の検出待機のタイムアウト設定を延長し、テストの安定性を向上させる'
    - 'マウスイベントが正確に動作しない場合に代替手段を提供する'
    - 'DOM要素の検出と操作のためのヘルパー関数を提供する'
    - 'テスト環境の制約を考慮したテスト条件の調整を行う'
  tests:
    - client/e2e/core/LNK-0005.spec.ts
    - client/e2e/core/LNK-0007.spec.ts
  notes:
    - 'テスト環境ではマウスイベントやDOM要素の検出が不安定な場合があるため、専用のヘルパー関数を使用してテストを安定化'
    - 'headlessモードでの実行時に一部の機能が正常に動作しない場合があるため、代替手段を提供'

- id: TST-0005
  title: 'テスト環境の初期化と準備'
  description: 'テスト実行前の環境準備を改善し、テストの安定性と再現性を向上させる'
  category: testing
  status: implemented
  acceptance:
    - 'テスト実行前にプロジェクトとページを自動的に作成する仕組みを提供する'
    - 'UI操作ではなくFluid APIを使用して直接データを作成することで安定性を向上させる'
    - 'テスト間の依存関係を減らし、各テストが独立して実行できるようにする'
    - 'テスト環境の初期化を一貫した方法で行うヘルパー関数を提供する'
    - 'DOM要素の検出問題を解決するための改善されたヘルパー関数を提供する'
  tests:
    - client/e2e/utils/testHelpers.ts
    - client/e2e/utils/linkTestHelpers.ts
    - client/e2e/helpers.ts
  notes:
    - 'テスト環境では要素の検出が不安定な場合があるため、再試行機能を持つヘルパー関数を使用してテストを安定化'
    - 'テストデータの作成にはUI操作ではなくFluid APIを使用し、テストの安定性を向上'
    - 'テスト前の環境準備を標準化することで、テスト間の依存関係を減少'

- id: NAV-0001
  title: 'プロジェクト選択とページナビゲーション'
  description: 'ルートページでプロジェクトを選択した場合にプロジェクトページへ遷移し、プロジェクトページからページリストを通じて個別ページへ遷移する機能'
  category: navigation
  status: implemented
  acceptance:
    - 'ルートページ(/)でプロジェクトを選択すると、対応するプロジェクトページ(/[project_name])へ遷移する'
    - 'プロジェクトページ(/[project_name])のページリストから、対応するページ(/[project_name]/[page_name])へ遷移するリンクが機能する'
    - 'プロジェクト選択後、プロジェクト内のページ一覧が表示される'
    - 'ページリストの各ページ名をクリックすると、そのページの内容が表示される'
  tests:
    - client/e2e/core/NAV-0001.spec.ts
