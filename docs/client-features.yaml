# DO NOT EDIT THIS FILE.
# This file is generated by scripts/aggregate_features.py.
# Edit per-feature YAMLs in docs/client-features/ or docs/dev-features/ and rerun the script.

- id: ACC-9e4c2a17
  title: 'Account menu: Sign out'
  title-ja: アカウントメニュー：サインアウト
  description: 'Clicking the login status indicator opens a dropdown with a single "Sign out" action.

    Selecting it logs out via Firebase Auth (UserManager.logout) and closes the menu.

    '
  category: auth
  status: implemented
  components:
  - client/src/components/LoginStatusIndicator.svelte
  services:
  - client/src/auth/UserManager.ts
  tests:
  - client/e2e/auth/user-menu-signout-9e4c2a17.spec.ts
  acceptance:
  - Clicking "Sign out" calls userManager.logout(), closes the menu, and the indicator shows "Not signed in" (data-status=unauthenticated)
  - Pressing Esc or clicking outside closes the menu
  - 'The menu contains exactly one actionable item: Sign out'
  - When authenticated, clicking the indicator toggles a menu anchored to it
  - When unauthenticated, clicking the indicator does nothing
- id: ADM-0001
  title: Production Data Deletion System
  title-ja: 本番環境データ削除システム
  description: Comprehensive system for safely deleting all production data including Firestore, Firebase Auth, and Firebase Storage with backup and safety checks.
  category: admin
  status: implemented
  components:
  - functions/index.js (deleteAllProductionData endpoint)
  - scripts/backup-production-data.js
  - scripts/check-production-environment.js
  - scripts/delete-production-data.js
  - scripts/production-data-manager.js
  services:
  - Firebase Functions API endpoint
  - Firebase Admin SDK
  - Command-line management scripts
  tests:
  - scripts/tests/environment-check.spec.js
  - scripts/tests/production-data-deletion.spec.js
  acceptance:
  - API endpoint requires admin token and confirmation code
  - Command-line scripts support interactive confirmation
  - Creates backup before deletion
  - Deletes all Firebase Auth users
  - Deletes all Firebase Storage files
  - Deletes all Firestore collections (users, containers, projects, schedules, user-containers)
  - Environment detection prevents accidental execution in test environments
  - Only works in production environment (not in emulator)
  - Provides comprehensive logging
  - Returns detailed deletion results
  security:
  - Admin token authentication (ADMIN_DELETE_ALL_DATA_2024)
  - Confirmation code requirement (DELETE_ALL_PRODUCTION_DATA_CONFIRM)
  - Production environment validation
  - Comprehensive audit logging
  - Backup creation before deletion
  documentation: docs/PRODUCTION_DATA_DELETION.md
- id: ALS-0001
  title: Alias node referencing existing items
  title-ja: 既存アイテムを参照するエイリアスノード
  category: outline
  status: implemented
  acceptance:
  - エイリアスは参照先アイテムへのパスを表示する
  - エイリアスノードを作成できる
  - エイリアスピッカーをキーボードで操作し確定できる
  - エイリアス展開時に参照先のサブツリーを編集できる
  - 変更は元のアイテムに反映される
  components:
  - client/src/components/AliasPicker.svelte
  - client/src/components/OutlinerItem.svelte
  - client/src/schema/app-schema.ts
  - client/src/stores/AliasPickerStore.svelte.ts
  - client/src/stores/CommandPaletteStore.svelte.ts
  tests:
  - client/e2e/new/als-alias-keyboard-navigation.spec.ts
  - client/e2e/new/als-alias-node-58ad30d4.spec.ts
  - client/e2e/new/als-alias-path-navigation.spec.ts
  - client/e2e/new/als-alias-self-reference-test.spec.ts
  - client/e2e/new/als-alias-target-change-f508c5a9.spec.ts
  - client/src/tests/integration/als-alias-keyboard-navigation.integration.spec.ts
  - client/src/tests/integration/als-alias-node-58ad30d4.integration.spec.ts
  - client/src/tests/integration/als-alias-path-navigation.integration.spec.ts
  - client/src/tests/integration/als-alias-self-reference-test.integration.spec.ts
- id: ALS-8a1f2c30
  title: Alias path fallback via lastConfirmedTargetId within 2s
  title-ja: 2秒以内の lastConfirmedTargetId フォールバックでエイリアスのパス表示
  description: 'OutlinerItem のエイリアス導出において、aliasPickerStore.lastConfirmedTargetId/lastConfirmedAt による

    暫定フォールバックが 2 秒以内であれば UI にターゲットのパスが表示されることを保証する。

    E2E では lastConfirmed* の直接設定でエイリアスパスの可視化と data-alias-target-id 反映を確認する。

    '
  category: outliner
  status: implemented
  components:
  - client/src/components/OutlinerItem.svelte
  - client/src/stores/AliasPickerStore.svelte.ts
  impact:
  - エイリアス確定直後の Yjs 反映前でも、ユーザーにパスが即座に見える
  tradeoffs:
  - 2 秒という時間窓の調整が必要（短すぎると UX 低下、長すぎると誤表示リスク）
  notes:
  - aliasPath/aliasTargetIdEffective は lastConfirmed* を安全に参照
  tests:
  - client/e2e/new/als-alias-fallback-lastconfirmed-8a1f2c30.spec.ts
- id: API-0001
  title: Fixing Firebase Functions API Server
  description: Firebase Functions APIサーバーのローカルテスト時のエラーを修正し、正常に動作するようにする機能
  category: api-server
  status: implemented
  acceptance:
  - CORS設定が正しく構成され、クロスオリジンリクエストが正常に処理される
  - Firebase Functions エミュレーターが正常に起動する
  - Firebase Hosting経由でのリクエストが正しくFunctionsにルーティングされる
  - deleteContainerエンドポイント（/api/deleteContainer）が認証エラーを適切に処理する
  - deleteUserエンドポイント（/api/deleteUser）が認証エラーを適切に処理する
  - getUserContainersエンドポイント（/api/getUserContainers）が認証エラーを適切に処理する
  - save-containerエンドポイント（/api/save-container）が認証エラーを適切に処理する
  - ヘルスチェックエンドポイント（/health）が正常に応答する
  - 'ポート設定が正しく構成される（Hosting: 57000）'
  - 必須パラメータが不足している場合に400エラーが返される
  - 無効なHTTPメソッドに対して405エラーが返される
  - 環境変数が正しく読み込まれ、Azure Fluid Relay設定が適用される
  - 認証に失敗した場合に401または500エラーが返される
  tests:
  - client/e2e/core/api-fixing-firebase-functions-api-server-9e65d78b.spec.ts
  - functions/test/firebase-functions.test.js
  components:
  - client/.env.localhost.test
  - firebase.json
  - functions/.env
  - functions/index.js
  title-ja: Firebase Functions APIサーバーの修正
- id: API-0002
  title: Firebase emulator startup standby function
  description: Firebase emulatorの起動を待つリトライ機能により、ECONNREFUSED エラーを回避する機能
  category: api-server
  status: implemented
  acceptance:
  - ECONNREFUSED エラーが発生した場合、指数バックオフでリトライする
  - ECONNREFUSED以外のエラーは即座に失敗とする
  - Firebase Auth emulatorへの接続テストを行い、成功するまで待機する
  - Firebase emulator環境変数が設定されている場合、emulatorの起動を待機する
  - emulator環境でない場合は待機をスキップする
  - リトライ回数と遅延時間をログに出力する
  - 接続成功時にユーザー数とユーザー情報をログに出力する
  - 最大30回のリトライを行い、初期遅延1秒、最大遅延10秒で待機する
  tests:
  - client/e2e/core/api-firebase-emulator-startup-standby-function-c9fa9c85.spec.ts
  - server/tests/log-service-emulator-wait.test.js
  components:
  - server/log-service.js
  title-ja: Firebase emulator起動待機機能
- id: API-0003
  title: Admin check for container user listing
  description: /api/get-container-users requires admin role
  category: api-server
  status: implemented
  acceptance:
  - 管理者はコンテナのユーザーリストを取得できる
  - 非管理者がアクセスした場合403エラーを返す
  tests:
  - client/e2e/core/api-admin-check-for-container-user-listing-bada0e86.spec.ts
  - server/tests/get-container-users.test.js
  components:
  - server/log-service.js
  title-ja: コンテナユーザーリストの管理者チェック
- id: API-0004
  title: Admin user list
  description: /api/list-users returns all users for admins only
  category: api-server
  status: implemented
  acceptance:
  - 管理者はFirebaseユーザー一覧を取得できる
  - 管理者以外のリクエストは403エラーを返す
  tests:
  - client/e2e/core/api-admin-user-list-569aaa6c.spec.ts
  - server/tests/log-service.test.js
  components:
  - server/log-service.js
  title-ja: 管理者ユーザーリスト
- id: API-0005
  title: Always use Firebase Hosting Functions URL
  category: api-server
  description: Client uses Firebase Hosting base URL for all function calls without fallback to local express ports.
  status: implemented
  acceptance:
  - API base URL defaults to http://localhost:57000 when environment variable is not set
  - No code paths reference the Functions emulator port directly
  tests:
  - client/src/tests/env-functions-url-default.test.ts
  components:
  - client/src/auth/UserManager.ts
  - client/src/lib/fluidService.svelte.ts
  - client/src/stores/firestoreStore.svelte.ts
  title-ja: Firebase Hosting経由のFunctions URLを常時使用
- id: APP-0001
  title: Set focus to global text area when viewing project pages
  description: プロジェクトページ表示時に自動的にグローバルテキストエリアにフォーカスを設定し、すぐに入力できるようにします。
  category: application
  status: implemented
  acceptance:
  - カーソルが表示される
  - プロジェクトページ表示時にグローバルテキストエリアにフォーカスが設定される
  - ユーザーがクリックせずに直接テキスト入力が可能になる
  tests:
  - client/e2e/core/app-set-focus-to-global-text-area-when-viewing-project-pages-d14affb9.spec.ts
  title-ja: プロジェクトページ表示時にグローバルテキストエリアにフォーカスを設定
- id: ATT-0001
  title: Drag and drop attachments
  title-ja: ドラッグ&ドロップで添付
  description: Items accept files via drag-and-drop and show image previews. Access control is based on Fluid Framework container permissions.
  category: attachments
  status: implemented
  components:
  - functions/index.js (uploadAttachment, listAttachments, deleteAttachment)
  - src/components/OutlinerItem.svelte
  - src/services/attachmentService.ts
  - storage.rules
  tests:
  - client/e2e/core/att-drag-and-drop-attachments-11f8904b.spec.ts
  - client/src/tests/attachmentService.test.ts
  - functions/test/attachments.test.js
  acceptance:
  - Access to attachments is controlled by Fluid Framework container permissions
  - 'Attachment file paths are organized by containerId: /attachments/{containerId}/{itemId}/{fileName}'
  - Files dropped on an item are uploaded to Firebase Storage
  - Multiple attachments can be added to the same item
  - Only users with access to the container can view, upload, or delete attachments
  - Uploaded attachments appear as image previews beneath the item
  notes:
  - In test environments using Tinylicious, container restoration may fail due to "default dataStore [rootDOId] must exist" error
  - This is a known Tinylicious bug that doesn't occur in production environments
  - Tests focus on upload functionality rather than persistence across page reloads
- id: ATT-7c19a2b4
  title: Attachments react to Yjs add/remove immediately
  title-ja: 添付ファイルの追加・削除が即時に UI に反映される
  description: 'Item.attachments（Y.Array<string>）に対する add/remove が OutlinerItem の添付プレビューに

    即時反映されることを検証する。最小粒度の Yjs observe（Y.Array/Y.Map）による反映で動作し、外部イベントや人工的な遅延に依存しない。

    '
  category: outliner
  status: implemented
  components:
  - client/src/components/OutlinerItem.svelte
  - client/src/schema/app-schema.ts
  impact:
  - 添付操作の操作感向上（即時性）
  tradeoffs:
  - なし（最小粒度の Yjs observe に依存）
  notes:
  - attachments は iterable/配列両対応のため、UI 側で配列化して描画
  - 観測ミラー方式（Yjs observe -> $state ミラー）へ移行し、UI はミラー配列のみを描画
  - E2E フォールバックを縮小（1px 画像や遅延タイマーを撤去）。テスト中は drop → model.addAttachment → observe で即時反映し、必要最小限の test-only CustomEvent のみ残す - injectAttachmentPreviewDom 撤去完了（DOM直挿しプレビューは廃止し、純Yjs表示に統一）
  tests:
  - client/e2e/new/att-attachments-reactive-7c19a2b4.spec.ts
- id: CDX-8f6d1c2b
  title: Home page loads after setup
  title-ja: セットアップ後にホームページが表示される
  description: The application shows the outliner page once the test environment is prepared.
  category: codex
  status: experimental
  acceptance:
  - At least one outliner item is rendered
  - Outliner base element becomes visible after setup
  tests:
  - client/e2e/core/out-outline-page-visible-3f2d8a9c.spec.ts
- id: CHK-0001
  title: Universal Checklist Component
  description: Checklist supporting shopping, packing and habit modes with optional recurrence rules.
  category: checklist
  status: draft
  components:
  - src/components/Checklist.svelte
  services:
  - src/services/checklistService.ts
  tests:
  - client/e2e/new/CHK-0001.spec.ts
  - client/src/tests/integration/CHK-0001.integration.spec.ts
  - src/tests/checklistService.test.ts
  acceptance:
  - Habit lists auto reset based on RRule
  - Items can be added to the checklist
  - Items can be toggled or archived based on mode
  - Reset button returns all items to active state
  title-ja: 汎用チェックリストコンポーネント
- id: CHT-001
  title: Chart Component
  description: 保存されたデータをグラフ表示するチャートコンポーネント
  category: visualization
  status: implemented
  components:
  - src/components/ChartComponent.svelte
  tests:
  - client/e2e/core/cht-chart-component-1b7a8eff.spec.ts
  acceptance:
  - データをグラフで表示する
  - データ更新時にグラフが自動更新される
  title-ja: チャートコンポーネント
- id: CLM-0001
  title: Click to enter edit mode
  shortcut: クリック
  description: クリックで編集モードに入ります。
  category: cursor-movement
  status: implemented
  tests:
  - client/e2e/core/clm-click-non-alt-edit-11765b4f.spec.ts
  - client/e2e/core/clm-cursor-blink-61a641e7.spec.ts
  - client/e2e/core/clm-cursor-position-aa9e87f6.spec.ts
  - client/e2e/core/clm-cursor-visible-c22414b4.spec.ts
  - client/e2e/core/clm-input-editable-c67b1dc8.spec.ts
  - client/e2e/core/clm-last-line-click-b8389849.spec.ts
  acceptance:
  - カーソルがクリック位置に表示される（最後の行を除く）
  - カーソルが点滅する
  - カーソルが表示される
  - クリックで編集モードに入る
  - 編集モードで文字入力が可能になる
  title-ja: クリックで編集モードに入る
- id: CLM-0002
  title: Move left
  shortcut: ←
  description: カーソルを1文字左に移動します。
  category: cursor-movement
  status: implemented
  acceptance:
  - カーソルを1文字左に移動する
  - 一番最初の文字にある時は、一つ前のアイテムの最後の文字へ移動する
  tests:
  - client/e2e/core/clm-move-left-b4e61244.spec.ts
  title-ja: 左へ移動
- id: CLM-0003
  title: Move to the right
  shortcut: →
  description: カーソルを1文字右に移動します。
  category: cursor-movement
  status: implemented
  acceptance:
  - カーソルを1文字右に移動する
  - 一番最後の文字にある時は、一つ次のアイテムの最初の文字へ移動する
  tests:
  - client/e2e/core/clm-move-to-the-right-c4f91a56.spec.ts
  title-ja: 右へ移動
- id: CLM-0004
  title: Move up
  shortcut: ↑
  description: カーソルを1行上に移動します。
  category: cursor-movement
  status: implemented
  acceptance:
  - カーソルを1行上に移動する
  - 一番上の行にある時で、一つ前のアイテムがない時は、同じアイテムの先頭へ移動する
  - 一番上の行にある時は、一つ前のアイテムの最後の行へ移動する。このとき、x座標の変化が最も小さい位置にカーソルをセットする。文字数が少ない場合は大きく移動する場合もある。カーソル上下以外の操作をしていない場合は、最初にカーソル上を押し始めた x座標からの変化が小さい位置にカーソルをセットする。
  - 一番上の行以外にある時は、同じアイテムの1行上へ移動する
  tests:
  - client/e2e/core/clm-move-up-line-move-06855626.spec.ts
  - client/e2e/core/clm-move-up-no-prev-item-9e8d4b10.spec.ts
  - client/e2e/core/clm-move-up-prev-item-6f0bdbc3.spec.ts
  title-ja: 上へ移動
- id: CLM-0005
  title: Move down
  shortcut: ↓
  description: カーソルを1行下に移動します。
  category: cursor-movement
  status: implemented
  acceptance:
  - カーソルを1行下に移動する
  - 一番下の行にある時で、一つ次のアイテムがない時は、同じアイテムの末尾へ移動する
  - 一番下の行にある時は、一つ次のアイテムの最初の行へ移動する。このとき、x座標の変化が最も小さい位置にカーソルをセットする。文字数が少ない場合は大きく移動する場合もある。カーソル上下以外の操作をしていない場合は、最初にカーソル下を押し始めた x座標からの変化が小さい位置にカーソルをセットする。
  - 一番下の行以外にある時は、同じアイテムの1行下へ移動する
  tests:
  - client/e2e/core/clm-move-down-4215682b.spec.ts
  title-ja: 下へ移動
- id: CLM-0007
  title: Go to the beginning of the line
  shortcut: Home
  description: カーソルを行の先頭に移動します。
  category: cursor-movement
  status: implemented
  acceptance:
  - Homeキーを押すと、カーソルが現在の行の先頭に移動する
  - 複数行のアイテムでは、現在のカーソルがある行の先頭に移動する
  tests:
  - client/e2e/core/clm-go-to-the-beginning-of-the-line-d39d158b.spec.ts
  title-ja: 行頭へ移動
- id: CLM-0008
  title: Go to the end of the line
  shortcut: End
  description: カーソルを行の末尾に移動します。
  category: cursor-movement
  status: implemented
  acceptance:
  - Endキーを押すと、カーソルが現在の行の末尾に移動する
  tests:
  - client/e2e/core/clm-go-to-the-end-of-the-line-03dfa6ef.spec.ts
  title-ja: 行末へ移動
- id: CLM-0100
  title: The cursor does not increase when normal clicks
  description: アイテム間を移動する際に、カーソルが増えないようにします。
  category: cursor-management
  status: implemented
  tests:
  - client/e2e/core/clm-the-cursor-does-not-increase-when-normal-clicks-1ac82e88.spec.ts
  acceptance:
  - アイテム間をクリックで移動しても、カーソルの数が増えない
  - 前のアイテムのカーソルは完全に削除される
  - 常に1つのカーソルだけが表示される
  title-ja: 通常クリックでカーソルが増えないこと
- id: CLM-0101
  title: Cursor duplication and input distribution problems when moving between items
  description: アイテム間を移動する際に、複数のカーソルが生成され、入力が複数のアイテムに分散する問題を検出します。
  category: cursor-management
  status: implemented
  tests:
  - client/e2e/core/clm-cursor-duplication-and-input-distribution-problems-when-moving-between-items-be4c0ba6.spec.ts
  acceptance:
  - 1番目のアイテムに「123」の繰り返しが表示される問題を検出する
  - 入力が複数のアイテムに分散する問題を検出する
  - 異なる位置に複数のカーソルが表示される問題を検出する
  - 複数のアイテムをクリックすると、複数のカーソルが生成される問題を検出する
  title-ja: アイテム間移動時のカーソル重複と入力分散問題
- id: CLM-0102
  title: Move cursors and multiple keyboard operations on empty text items
  description: 空のテキストアイテムでのカーソル移動と、クリック後の複数回のキーボード操作が正しく機能することを確認します。
  category: cursor-management
  status: implemented
  tests:
  - client/e2e/core/clm-move-cursors-and-multiple-keyboard-operations-on-empty-text-items-20043fb0.spec.ts
  acceptance:
  - アイテム間を移動しても常に1つのカーソルだけが表示される
  - クリック後に複数回のキーボード操作でカーソルが正しく移動する
  - 入力が正しいアイテムに行われる
  - 空のテキストアイテム間をキーボードで移動できる
  title-ja: 空のテキストアイテムでのカーソル移動と複数回のキーボード操作
- id: CLM-0103
  title: Cursor manipulation with format strings
  description: フォーマット（太字、斜体など）が適用された文字列内でのカーソル移動が正しく機能することを確認します。
  category: cursor-movement
  status: implemented
  tests:
  - client/e2e/core/clm-cursor-manipulation-with-format-strings-86f0d787.spec.ts
  acceptance:
  - Home/Endキーがフォーマット文字列で正しく機能する
  - Shift+矢印キーによる選択がフォーマット文字列で正しく機能する
  - フォーマット文字列内でのカーソル移動が正しく機能する
  - 複数のフォーマットが混在する文字列でのカーソル移動が正しく機能する
  title-ja: フォーマット文字列でのカーソル操作
- id: CLM-0104
  title: Extended navigation commands
  title-ja: 拡張ナビゲーションコマンド
  description: Ctrl+Left/Right word jumps, bracket jump with Ctrl+Shift+\, document navigation with Ctrl+Home/End, PageUp/PageDown and scroll commands.
  category: cursor-movement
  status: implemented
  tests:
  - client/e2e/core/clm-extended-navigation-commands-427d145e.spec.ts
- id: CLM-0105
  title: Dictionary-based key handler
  title-ja: 辞書型キー処理
  description: KeyEventHandler uses CustomKeyMap to map key combinations to handlers.
  category: cursor-management
  status: implemented
  tests:
  - client/e2e/core/clm-dictionary-key-handler-59169a01.spec.ts
- id: CLM-1cef29b1
  title: Cursor count stable after drag
  description: ドラッグでアイテムを移動してもカーソルの数は変化しません。
  category: cursor-management
  status: implemented
  acceptance:
  - アイテムをドラッグして移動したあともカーソルの総数が変わらない
  tests:
  - client/e2e/core/clm-cursor-count-stable-after-drag-1cef29b1.spec.ts
  title-ja: ドラッグ後もカーソル数は変化しない
- id: CLM-5d2a7b4c
  title: Cursor formatting delegates to CursorEditor
  description: 'Formatting shortcuts such as bold, italic, and code blocks are processed

    through the CursorEditor class. Selecting a range and triggering a

    formatting command updates the text without losing cursor position or the

    active item.

    '
  category: cursor-management
  status: implemented
  acceptance:
  - Bold formatting wraps the selected text with Scrapbox [[...]] markers via CursorEditor.
  - Code formatting delegates to CursorEditor and wraps the selection in backticks.
  - Italic formatting uses CursorEditor to apply [/...]-style Scrapbox markup.
  tests:
  - client/e2e/core/clm-cursor-editor-formatting-5d2a7b4c.spec.ts
  title-ja: CursorEditor によるフォーマット操作の委譲
- id: CLM-7f3b1a2c
  title: Cursor editing flows through CursorEditor
  description: 'The primary editing shortcuts are routed through the new CursorEditor class.

    Users can insert characters, delete text, and split items while staying on the

    same page without losing cursor state.

    '
  category: cursor-management
  status: implemented
  acceptance:
  - Backspace and Delete remove characters via the delegated editor logic.
  - Splitting an item with Enter creates a sibling item and keeps the cursor active.
  - Typing characters updates the active item using the CursorEditor pipeline.
  tests:
  - client/e2e/core/clm-cursor-editor-delegates-7f3b1a2c.spec.ts
  title-ja: CursorEditor によるカーソル編集の委譲
- id: CMD-0001
  title: Inline Command Palette
  title-ja: インラインコマンドパレット
  description: Type '/' within an item to open a palette for inserting tables or charts.
  category: editing
  status: implemented
  components:
  - src/components/ChartPanel.svelte
  - src/components/InlineJoinTable.svelte
  - src/components/SlashCommandPalette.svelte
  tests:
  - client/e2e/new/CMD-0001.spec.ts
  acceptance:
  - Arrow keys move the selection within the palette
  - Pressing Enter on 'table' inserts an inline table
  - Pressing Enter on the filtered command inserts that component
  - Typing '/' with focus on an item shows the command palette
  - Typing a filter such as 'ch' narrows the command list
- id: CMT-0001
  title: Comment threads per item
  title-ja: アイテムごとのコメントスレッド
  category: collaboration
  status: implemented
  acceptance:
  - Comment count appears next to the item
  - Comments synchronize in real-time between clients
  - Users can edit and delete their comments
  - Users can open a comment thread for an item
  components:
  - client/src/components/CommentThread.svelte
  - client/src/components/OutlinerItem.svelte
  - client/src/schema/app-schema.ts
  - client/src/stores/OutlinerViewModel.ts
  tests:
  - client/e2e/new/cmt-comment-thread-basic.spec.ts
  - client/src/stores/OutlinerViewModel.test.ts
  - client/src/tests/integration/cmt-derived-renders-9ab3c1d2.integration.spec.ts
- id: CMT-5fd8c210
  title: OutlinerItem comment badge reflects Yjs count (max logic)
  title-ja: コメント数バッジは Yjs の件数（最大値ロジック）を表示する
  description: 'OutlinerItem の commentCountVisual は Yjs 由来値とローカルフォールバックの最大値を用いる。

    Yjs 側で add/delete を行った際に、バッジの件数が正確に増減し、最大値を表示することを確認する。

    '
  category: comments
  status: implemented
  components:
  - client/src/components/CommentThread.svelte
  - client/src/components/OutlinerItem.svelte
  impact:
  - コメント件数の視認性と整合性が向上
  tradeoffs:
  - DOM フォールバックによる一時的上書きの経路が残るため、将来的に整理予定
  notes:
  - スレッド未展開時でも Y.Array('comments') の observe により件数が更新される（最小粒度の Yjs observe）
  tests:
  - client/e2e/new/cmt-comment-badge-max-5fd8c210.spec.ts
- id: CNT-12ee98aa
  title: Shared Container Store
  title-ja: 共有コンテナストア
  description: Expose accessible containers via a global store for reuse across components. The dropdown list is populated after user login and updated when new containers are created.
  category: project
  status: implemented
  components:
  - src/components/ContainerSelector.svelte
  - src/routes/projects/delete/+page.svelte
  - src/stores/containerStore.svelte.ts
  services:
  - src/lib/fluidService.svelte
  - src/stores/firestoreStore.svelte.ts
  tests:
  - client/e2e/new/cnt-container-selector-updates-after-new-container-cb2f94a1.spec.ts
  - client/e2e/new/cnt-shared-container-store-12ee98aa.spec.ts
  - client/src/stores/ContainerStore.test.ts
  - client/src/tests/integration/cnt-shared-container-store-12ee98aa.integration.spec.ts
  acceptance:
  - ContainerSelector lists containers from the shared store
  - Deletion page displays projects from the shared store
  - Dropdown list is populated after user login
  - Dropdown list is updated after creating new containers
- id: CNT-7b28a4f0
  title: Eventless ContainerSelector via ucVersion
  title-ja: イベントレスなContainerSelector（ucVersion依存）
  description: 'ContainerSelector から CustomEvent 依存（firestore-user-container-changed）を完全に排除し、

    firestoreStore.ucVersion と Svelte 5 の $state/$derived だけで安定に再計算できることを証明する。

    setUserContainer の差し替え経路および Proxy による配列 push/pop の両方で ucVersion++ により

    即時反映される設計を維持しつつ、テスト環境では ucVersion の変化をポーリングして redraw を

    バックストップするフォールバックを追加。E2E で fluidService 経由の setUserContainer 差し替えが

    実 UI の option 増加に直結することを確認した。

    '
  category: project
  status: implemented
  components:
  - client/src/components/ContainerSelector.svelte
  - client/src/stores/firestoreStore.svelte.ts
  - client/src/tests/components/TestContainerSelector.svelte
  - client/src/tests/fixtures/UserContainerDisplay.svelte
  impact:
  - ContainerSelector は firestoreStore.ucVersion と内部 redraw バックストップのみを依存に持つ
  - setUserContainer 差し替え／配列 push/pop の双方で ucVersion++ により即時 UI 反映
  - firestoreStore.setUserContainer から CustomEvent 発火を削除し、ログ出力で差分を可視化
  tradeoffs:
  - ucVersion バージョンカウンタという追加状態は継続して管理する必要がある
  - テスト環境専用の再描画ポーリングは本番では動作しない（不要なコストはかからないが分岐が増える）
  notes:
  - containerStore.containers は getter のまま。名前解決は従来どおり
  - Production 相当の短い E2E で fluidService.createClient → setUserContainer 差し替え → option 増加を検証
  - firestoreStore.setUserContainer の INFO ログで ucVersion・アクセス可能数・既定 ID の変化を追跡可能
  tests:
  - client/e2e/new/cnt-container-selector-setusercontainer-reflects-7b28a4f0.spec.ts
  - client/src/tests/integration/cnt-container-selector-reactivity-e3f1a9c2.integration.spec.ts
- id: CNT-9f3a7c21
  title: ContainerSelector Stable Recalculation (PoC)
  title-ja: ContainerSelectorの安定再計算（PoC）
  description: 'Reduce reliance on CustomEvent for ContainerSelector reactivity and validate that $state/$derived-only

    dependencies can drive stable DOM updates. Introduced a $state-based version counter (ucVersion) on

    firestoreStore that increments on setUserContainer and Proxy-driven array mutations. ContainerSelector

    now derives its options based on firestoreStore.ucVersion and containerStore.containers, while a

    test-only polling fallback keeps redraws in sync when initialization races occur.

    '
  category: project
  status: implemented
  components:
  - client/src/components/ContainerSelector.svelte
  - client/src/stores/containerStore.svelte.ts
  - client/src/stores/firestoreStore.svelte.ts
  impact:
  - コンポーネント側の再計算は firestoreStore.ucVersion への依存で発火
  - setUserContainer 差し替え経路／Proxy 破壊的変更の両方で ucVersion++ により即時反映
  - テスト環境で ucVersion ポーリングを走らせることで初期化レースを緩和
  tradeoffs:
  - $state のトップレベル依存に寄せたため、ストア内にバージョンカウンタを持つ設計負債が増える
  - ポーリングはテスト環境限定とはいえ、コードパスが複雑化する
  notes:
  - containerStore.containers は getter のまま。コンテナ名解決は従来通り。
  - 現行フェーズでは CustomEvent を完全に排除済み。PoC の成果を Production 相当フローで確認済み。
  - 今後は ucVersion 自体の整理（より宣言的な reactivity 経路への移行）を検討。
  tests:
  - client/src/tests/integration/cnt-container-selector-reactivity-e3f1a9c2.integration.spec.ts
  - client/src/tests/integration/snapshot-diff-modal-a11y-9f2d1c3a.integration.spec.ts
- id: COL-a8219d57
  title: Yjs collaboration typing sync
  title-ja: Yjs コラボレーションのタイピング同期
  status: experimental
  tests:
  - client/e2e/new/col-typing-sync-a8219d57.spec.ts
- id: COL-b7a9c2d1
  title: Show collaborator cursor positions
  title-ja: コラボレーターのカーソル位置を表示する
  description: Display remote collaborators' cursors and text selections in real time so teamwork stays coordinated.
  category: collaboration
  status: implemented
  acceptance:
  - Cursor indicators disappear promptly when the collaborator disconnects or closes the session
  - Remote collaborator cursor positions update live when another session moves the caret
  - Remote text selections reuse the collaborator's assigned color across items and box selections
  tests:
  - client/e2e/core/col-show-collaborator-cursor-positions-b7a9c2d1.spec.ts
- id: COL-bedbc307
  title: Displaying cursors for other users
  description: 複数ユーザーが同じページを編集しているとき、他ユーザーのカーソル位置をリアルタイムに表示する
  category: collaboration
  status: implemented
  acceptance:
  - Fluid Framework の signal 機能でカーソル位置を同期する
  - 他ユーザーがカーソルを移動すると、その位置が表示される
  tests:
  - client/e2e/core/col-displaying-cursors-for-other-users-bedbc307.spec.ts
  title-ja: 他ユーザーのカーソル表示
- id: CTD-8c6d1ad4
  title: Cloudflare Tunnel setup documentation
  title-ja: Cloudflare Tunnel 設定ドキュメント
  description: Sample configuration and setup steps for exposing WSS via Cloudflare Tunnel.
  status: implemented
  tests:
  - client/e2e/ctd-cloudflare-tunnel-docs-8c6d1ad4.spec.ts
- id: DBW-001
  title: Client-Side SQL Database
  description: IndexedDB上にSQLデータベースを構築し、オフラインでページを保存できる機能
  category: database
  status: implemented
  tests:
  - client/e2e/new/DBW-001.spec.ts
  title-ja: クライアント側SQLデータベース
- id: DEL-0001
  title: Project Deletion Page
  title-ja: プロジェクト削除ページ
  description: Dedicated page listing all user projects with checkboxes to delete inaccessible or unwanted containers.
  category: project
  status: draft
  components:
  - src/routes/projects/delete/+page.svelte
  services:
  - src/lib/fluidService.svelte
  - src/stores/firestoreStore.svelte.ts
  tests:
  - client/e2e/new/DEL-0001.spec.ts
  acceptance:
  - Clicking Delete removes the selected projects
  - Multiple projects can be selected via checkboxes
  - Users can see all project container IDs and titles
- id: EVC-9c85e4b2
  title: Evict expired tokens from WebSocket auth cache
  title-ja: WebSocket認証キャッシュから期限切れトークンを削除
  status: proposed
  tests:
  - server/tests/websocket-auth.test.js::removes expired tokens from cache
- id: FLD-0001
  title: Ability to retrieve FluidClient from project title
  description: clientRegistryを走査して、Project.titleが一致するFluidClientインスタンスを取得する機能。プロジェクトタイトルとFluid containerのIDは1:1の対応関係にある。
  category: fluid-service
  status: implemented
  acceptance:
  - clientRegistryに登録されている全てのFluidClientを走査して一致するものを探す
  - プロジェクトタイトルからFluidClientインスタンスを取得できる
  - プロジェクトタイトルが指定されていない場合はエラーを返す
  - プロジェクトタイトルに一致するFluidClientが見つからない場合はundefinedを返す
  - プロジェクトレイアウトでこの機能を使用してプロジェクトデータを読み込める
  - 取得したFluidClientインスタンスを使用してプロジェクトデータにアクセスできる
  - 新しいプロジェクトを作成してからFluidClientを取得できる
  tests:
  - client/e2e/core/fld-ability-to-retrieve-fluidclient-from-project-title-f3bf0fec.spec.ts
  title-ja: プロジェクトタイトルからFluidClientを取得する機能
- id: FMT-0001
  title: Format display
  description: Scrapbox構文のフォーマットを視覚的に表示する機能
  category: text-formatting
  status: implemented
  acceptance:
  - Scrapbox構文のUXをクローンし、編集中はプレーンテキスト、非編集時はフォーマット表示となる
  - カーソルがあるアイテムではプレーンテキストの入力内容がそのまま表示される
  - カーソルがないアイテムではフォーマットされた内容が表示される
  - コードフォーマット（`text`）が視覚的にコードスタイルで表示される
  - 取り消し線フォーマット（[- text]）が視覚的に取り消し線付きで表示される
  - 太字フォーマット（[[text]]）が視覚的に太字で表示される
  - 斜体フォーマット（[/ text]）が視覚的に斜体で表示される
  tests:
  - client/e2e/core/fmt-format-display-048d107c.spec.ts
  title-ja: フォーマット表示
- id: FMT-0002
  title: Format combination
  description: Scrapbox構文の複数フォーマットの組み合わせを視覚的に表示する機能
  category: text-formatting
  status: implemented
  acceptance:
  - カーソルがあるアイテムでは組み合わせフォーマットもプレーンテキストで表示される
  - 太字と取り消し線の組み合わせが正しく表示される
  - 太字と斜体の組み合わせが正しく表示される
  - 斜体とコードの組み合わせが正しく表示される
  - 複数のフォーマットが入れ子になっている場合も正しく表示される
  tests:
  - client/e2e/core/fmt-format-combination-bcb56231.spec.ts
  title-ja: フォーマット組み合わせ
- id: FMT-0003
  title: Extended format
  description: Scrapbox構文の拡張フォーマット（リンク、引用）を視覚的に表示する機能
  category: text-formatting
  status: implemented
  acceptance:
  - カーソルがあるアイテムでは拡張フォーマットもプレーンテキストで表示される
  - リンク構文（[URL]）が正しくリンクとして表示される
  - 引用構文（> テキスト）が正しく引用として表示される
  - 複合フォーマット（引用内の太字や斜体など）が正しく表示される
  tests:
  - client/e2e/core/fmt-extended-format-b471a4b9.spec.ts
  title-ja: 拡張フォーマット
- id: FMT-0004
  title: Paste and format from the clipboard
  description: クリップボードからのテキストペーストとフォーマット保持機能
  category: text-formatting
  status: implemented
  acceptance:
  - カーソル位置にテキストがペーストされる
  - フォーマット構文を含むテキストのペーストが正しく機能する
  - プレーンテキストのペーストが正しく機能する
  - ペーストされたフォーマット構文が視覚的に正しく表示される
  - 複数行テキストのペーストが正しく機能する
  tests:
  - client/e2e/core/fmt-paste-and-format-from-the-clipboard-fe4971c2.spec.ts
  title-ja: クリップボードからのペーストとフォーマット
- id: FMT-0005
  title: VS Code style clipboard behavior
  category: text-formatting
  status: implemented
  description: Copying and pasting using multi-cursors or box selection should behave the same as Visual Studio Code. Metadata in the clipboard is interpreted so each cursor receives the expected text.
  acceptance:
  - Box selection paste inserts each line of text into the corresponding selection range
  - Clipboard operations work when triggered via keyboard shortcuts
  - Pasting with application/vscode-editor metadata distributes text across multiple cursors
  tests:
  - client/e2e/core/fmt-vscode-clipboard-behavior-3807f353.spec.ts
  title-ja: VS Code風クリップボード操作
- id: FMT-0006
  title: Consistency of format display when moving cursors
  description: カーソル移動時にフォーマット表示が一貫して適切に切り替わることを確認します
  category: text-formatting
  status: implemented
  acceptance:
  - カーソルがあるアイテムでは制御文字（[[]], [/], [-], `）が表示される
  - カーソルがないアイテムでは制御文字が非表示でフォーマットが適用される
  - カーソル移動時に表示が適切に切り替わる
  - タイトル（最初の行）は通常のテキスト表示される（ボールド表示されない）
  - リンク構文（[ text]]）が正しくリンクとして表示される
  tests:
  - client/e2e/core/fmt-consistency-of-format-display-when-moving-cursors-36199743.spec.ts
  title-ja: カーソル移動時のフォーマット表示の一貫性
- id: FMT-0007
  title: Displaying internal link function
  description: /project-name/page-name 形式の内部リンクをサポートする機能
  category: text-formatting
  status: implemented
  acceptance:
  - '[/project-name/page-name] 形式の内部リンクが正しく表示される'
  - '[page-name] 形式の内部リンクが正しく表示される'
  - カーソルがあるアイテムでは内部リンクもプレーンテキストで表示される
  - カーソルがないアイテムでは内部リンクが視覚的にリンクとして表示される
  tests:
  - client/e2e/core/fmt-displaying-internal-link-function-a8a7c97e.spec.ts
  title-ja: 内部リンク機能の表示
- id: FMT-0008
  title: Support multiple internal links in one item
  title-ja: 1アイテム内で複数の内部リンクをサポート
  description: 単一のアイテム内で複数の内部リンクを正しく表示・動作させる
  category: text-formatting
  status: implemented
  acceptance:
  - 1アイテム内に複数の [page] と [/project/page] リンクを含めてもすべてがリンクとして表示される
  - E2E テストが成功する
  - ScrapboxFormatter.formatToHtml で複数リンクが適切に生成される
  - カーソルがある場合はプレーンテキスト表示となる
  - ページ存在チェッククラス page-exists/page-not-exists がそれぞれ適用される
  - リンクをクリックすると正しいページへ遷移する
  - 各リンクにリンクプレビューが表示される
  tests:
  - client/e2e/core/fmt-multiple-internal-links-3a606671.spec.ts
  - client/src/utils/ScrapboxFormatter.test.ts
- id: FMT-a391b6c2
  title: URL label links
  title-ja: URLラベルリンク
  description: Convert bracketed URL and label pairs into links that display only the label text.
  category: text-formatting
  status: implemented
  acceptance:
  - Bracketed pairs [URL label] render the label text linked to the URL.
  - No URL text remains visible when a label is provided.
  - Plain URLs are converted to clickable links.
  tests:
  - client/e2e/core/fmt-url-label-links-a391b6c2.spec.ts
  - client/src/tests/integration/linkFormat.test.ts
  - client/src/utils/ScrapboxFormatter.test.ts
- id: FSE-9d3f2b1c
  title: Firestore store exposed on window
  title-ja: windowに公開されるFirestoreストア
  description: Firestoreストアがテスト環境でwindowオブジェクトに公開されることを確認する。
  status: implemented
  tests:
  - client/e2e/core/fse-firestore-store-exposed-9d3f2b1c.spec.ts
- id: FTR-0013
  title: Use environment variables in min page
  status: implemented
  components:
  - client/.env.example
  - client/src/routes/min/+page.svelte
  tests:
  - client/e2e/core/ftr-use-environment-variables-in-min-page-cfe01fbf.spec.ts
  acceptance:
  - Firebase config values come from VITE_FIREBASE_* variables
  - Token verification URL uses VITE_TOKEN_VERIFY_URL
  title-ja: 最小ページで環境変数を使用します
- id: FTR-124575e6
  title: User can reset forgotten password
  status: implemented
  components:
  - lib/email/resetPassword.ts
  - routes/auth/forgot.svelte
  tests:
  - client/e2e/core/ftr-user-can-reset-forgotten-password-124575e6.spec.ts
  acceptance:
  - ユーザーがメールアドレスを入力すると、リセットリンクが送信される
  - リンクは 30 分で失効する
  - 正しいトークンを送るとパスワードを再設定できる
  title-ja: ユーザーは忘れられたパスワードをリセットできます
- id: FTR-1ec8f72b
  title: Structured logging with redaction
  title-ja: 構造化ログとマスキング
  description: Server emits JSON logs and redacts sensitive data; Playwright tests import the compiled logger to verify redaction.
  category: server
  status: implemented
  tests:
  - client/e2e/utils/srv-structured-logging-1ec8f72b.spec.ts
  - server/tests/logger-redaction.test.js
  - server/tests/server-logging.test.js
- id: FTR-2fae53c9
  title: Server metrics endpoint
  title-ja: サーバーメトリクスエンドポイント
  description: Exposes connection and message rate metrics.
  category: server
  status: implemented
  tests:
  - client/e2e/2fa-server-metrics-endpoint-2fae53c9.spec.ts
- id: FTR-3f7a0c9b
  title: WebSocket connection limits
  title-ja: WebSocket接続制限
  description: Limits total, per-IP, and per-room WebSocket connections and enforces idle timeout and message size.
  status: experimental
  components:
  - server/src/config.ts
  - server/src/server.ts
  services:
  - WebSocket server
  - Firebase Auth
  tests:
  - client/e2e/ws-connection-limit-3f7a0c9b.spec.ts
  - server/tests/connection-limits.test.js
- id: FTR-7fa5a073
  title: Local Y.Doc Caching and Offline Editing
  title-ja: ローカルY.Docキャッシュとオフライン編集
  description: 'Full Y.Doc content for each container is persisted locally in IndexedDB, enabling offline editing and fast reconnection without requiring a backend. Every outliner container''s Y.Doc (Yjs document) is automatically cached in the browser''s IndexedDB, allowing users to edit containers without an internet connection and restore content instantly from local cache on page reload.

    '
  category: persistence
  status: implemented
  components:
  - src/lib/metaDoc.svelte.ts
  - src/lib/yjsPersistence.ts
  - src/lib/yjsService.svelte.ts
  services:
  - y-indexeddb (IndexedDB persistence)
  tests:
  - client/e2e/ydoc-persistence.spec.ts
  - client/src/lib/yjsPersistence.test.ts
  acceptance:
  - Changes merge correctly when connectivity is restored (via Yjs CRDT)
  - Container content is restored instantly from local cache on page reload
  - Load sequence prioritizes local cache before any backend synchronization
  - Metadata Y.Doc integration allows dropdown title display to work correctly
  - Multiple containers maintain independent caches
  - Offline edits are persisted locally and survive browser restarts
  - Users can edit containers while offline without network connectivity
  - Y.Doc content is automatically cached in IndexedDB for each container
  implementation:
    storage: 'IndexedDB via `y-indexeddb` library with database schema:

      - Container Y.Docs: `"container-<containerId>"` database name

      - Metadata Y.Doc: `"outliner-meta"` database name (from #1061)

      '
    auto_save: 'Changes are persisted automatically on every Y.Doc update via

      y-indexeddb''s built-in persistence mechanism

      '
    load_sequence: '1. Create new Y.Doc instance

      2. Attach IndexedDB persistence with container-specific key

      3. Wait for initial sync from IndexedDB

      4. Bind editor to restored Y.Doc state

      5. Apply any remote updates (when backend available)

      '
    integration_with_metadata_cache: "The full Y.Doc caching works alongside the metadata cache:\n- Metadata Y.Doc: Stores container titles and lightweight metadata\n- Full Y.Doc cache: Stores complete document content\n- Shared container IDs: Both use the same container identifier scheme\n- Title resolution priority:\n  1. Metadata Y.Doc title\n  2. Live project title\n  3. Container ID fallback\n"
  related_issues:
  - '#1061: Metadata Y.Doc for container titles (parent design reference)'
  - '#1083: Create IndexedDB persistence wrapper module'
  - '#1084: Integrate IndexedDB persistence into container creation'
  - '#1086: Add unit tests for Y.Doc persistence and cache restoration'
  - '#1087: Add E2E tests for offline editing and cache restoration'
  future_enhancements:
  - Backend synchronization provider
  - Multi-device sync via remote provider
  - Cache size limits and cleanup policies
  - Advanced merge conflict resolution UI
- id: FTR-a1b2c3d4
  title: Container Title Persistence
  title-ja: コンテナタイトル永続化
  description: 'Persist container titles in a local-only Y.Doc for reliable display in the home dropdown across page reloads.


    This feature introduces a metadata Y.Doc (metaDoc) that stores container titles locally in IndexedDB. When building the home dropdown options, the system resolves container labels using a three-tier fallback chain:

    1. First, try to read the title from metaDoc (metadata Y.Doc)

    2. If not available, fall back to getProjectTitle (from live Yjs project)

    3. If neither yields a non-empty title, use the raw container ID as the label


    This ensures that containers remain visible in the home dropdown even after full page reloads or new browser sessions. The metaDoc is persisted using y-indexeddb and is never synchronized with any backend, making it strictly a local cache for container metadata.

    '
  category: project
  status: implemented
  components:
  - client/src/lib/metaDoc.svelte
  - client/src/stores/containerStore.svelte.ts
  services:
  - client/src/lib/projectTitleProvider
  - client/src/lib/yjsService.svelte
  tests:
  - client/e2e/container-title-persistence.spec.ts
  acceptance:
  - Container titles are persisted in a local-only Y.Doc (metaDoc)
  - Containers remain visible in home dropdown after page reload
  - Home dropdown resolves labels using metaDoc → getProjectTitle → ID fallback chain
  - Multiple containers maintain independent titles in metaDoc
  - When titles cannot be resolved, container IDs are displayed instead of hiding entries
  - metaDoc is persisted in IndexedDB and survives page reloads
- id: FTR-b6ebf516
  title: Paste text from the system clipboard
  description: 'Allow pasting text copied outside the app using the native clipboard API.

    `KeyEventHandler.handlePaste` is asynchronous and should be awaited so

    permission or read failures dispatch `clipboard-permission-denied` or

    `clipboard-read-error` events and no text is inserted. When clipboard data is

    unavailable the handler falls back to `window.lastCopiedText`.

    '
  category: editing
  status: implemented
  acceptance:
  - Text copied in another application can be pasted into an item with Ctrl+V
  - The pasted text appears at the cursor position
  tests:
  - client/e2e/core/clp-system-clipboard-paste-b6ebf516.spec.ts
  title-ja: システムクリップボードからのテキストペースト
- id: FTR-bd6b971b
  title: yjsService operations API
  title-ja: yjsService 操作API
  description: Provides basic tree operations and presence helpers for Yjs.
  category: api
  status: implemented
  tests:
  - client/e2e/new/yjs-service-operations-bd6b971b.spec.ts
  - client/src/tests/integration/yjs-service-operations-bd6b971b.integration.spec.ts
- id: FTR-cbe91364
  title: Remove Fluid token endpoint
  title-ja: Fluidトークンエンドポイントの削除
  description: Remove legacy Fluid token endpoint and client calls.
  category: backend
  status: implemented
  acceptance:
  - /api/fluidToken returns 404
  - UserManager exposes no Fluid token methods
  tests: []
  validation: 'This legacy endpoint remains disabled via hosting/Vite middleware and production configuration.

    During the Yjs migration, all Fluid Token tests were retired because there is no Yjs equivalent.

    Behavior is validated by server routing and manual verification in production-like environments.

    '
  components:
  - client/src/auth/UserManager.ts
  - client/src/lib/fluidService.svelte.ts
  - functions/index.js
- id: FTR-d67f3a5b
  title: Server health endpoint
  title-ja: サーバーヘルスエンドポイント
  description: Health check endpoint returns OK.
  category: server
  status: implemented
  tests:
  - client/e2e/d67-server-health-endpoint-d67f3a5b.spec.ts
- id: FTR-db5e7a9c
  slug: db5
  title: LevelDB persistence
  status: implemented
  title-ja: LevelDB 永続化
  description: Persistence layer using LevelDB for local data storage.
  components: []
  category: server
  tests:
  - client/e2e/new/db5-leveldb-persistence-db5e7a9c.spec.ts
- id: FTR-dc38b81a
  slug: srv
  title: Server backup script creates timestamped archive
  title-ja: サーバーバックアップスクリプトがタイムスタンプ付きアーカイブを作成する
  description: Nightly script archives server data and uploads via rclone with retention.
  category: server
  status: implemented
  components:
  - server/scripts/rclone-backup.js
  tests:
  - client/e2e/core/server-backup-script-runs-dc38b81a.spec.ts
- id: GBS-7dd8407f
  title: Global Store Proxy
  title-ja: グローバルストアプロキシ
  description: Removed. We eliminated the thin facade (GlobalStore proxy). UI imports backend stores directly (yjsStore, appStore, firestoreStore).
  category: project
  status: removed
  components: null
  services:
  - src/stores/store.svelte.ts
  - src/stores/fluidStore.svelte.ts
  - src/stores/firestoreStore.svelte.ts
  tests:
  - client/src/tests/integration/globalStore.integration.spec.ts
  acceptance:
  - Setting project via the proxy updates the underlying store
  - The proxy exposes page data from the Fluid store
- id: GRV-0001
  title: Graph View visualization
  title-ja: グラフビュー可視化
  description: Visualize inter-page links as an interactive graph that updates in real time when pages change.
  category: navigation
  status: implemented
  components:
  - client/src/components/GraphView.svelte
  - client/src/routes/graph/+page.svelte
  features:
  - Parse page links to build a graph structure
  - Allow navigation to pages by clicking nodes
  - Support real-time updates when links change
  - Display interactive graph using ECharts
  acceptance:
  - Clicking a node navigates to the correct page
  - E2E tests verify graph page navigation and real-time updates
  - Graph renders using project data on /graph page
  - Graph updates automatically when pages or links change
  - Unit test verifies chart update logic
  interfaces:
  - GraphView
  - store.pages
  - TreeSubscriber
  - ECharts
  resources: []
  tests:
  - client/e2e/new/GRV-002.spec.ts
  - client/e2e/new/grv-graph-view-navigation-34a26488.spec.ts
- id: HDV-0001
  title: Page snapshot diff viewer
  title-ja: ページのスナップショット差分ビューア
  category: history
  status: implemented
  description: 'Allow users to view differences between the current page state and previous snapshots.

    Users can select two snapshots to see changes and revert to a chosen version.

    '
  acceptance:
  - Diff displays insertions and deletions.
  - Revert replaces current page content with selected snapshot.
  - Selecting a snapshot shows diff within one second for pages up to 50KB.
  - Snapshot list shows timestamp and author.
  tests:
  - client/e2e/new/diff-view.spec.ts
  - client/src/tests/snapshotService.spec.ts
- id: IME-0001
  title: Japanese input using IME
  status: implemented
  tests:
  - client/e2e/core/ime-japanese-input-using-ime-59109b4a.spec.ts
  acceptance:
  - IMEを使用した日本語入力が可能になる
  - 入力途中の文字がカーソル位置に表示される
  - 変換候補がカーソル位置に表示される
  title-ja: IMEを使用した日本語入力
- id: IME-0002
  title: IME candidate window follows active cursor
  title-ja: IME変換候補ウィンドウがアクティブカーソルに追従する
  category: cursor-management
  status: implemented
  tests:
  - client/e2e/core/ime-candidate-window-follows-cursor-eebdd197.spec.ts
  acceptance:
  - Hidden textarea used for IME input is positioned at the last active cursor so the OS candidate window appears at the correct location
- id: IME-0003
  title: IME composition underline follows active cursor
  title-ja: IME変換アンダーラインがアクティブカーソルに表示される
  category: input-method
  status: implemented
  tests:
  - client/e2e/core/ime-composition-underlines-at-cursor-b11a6c1a.spec.ts
  acceptance:
  - Hidden textarea gains ime-input class during composition so the OS underline appears at the cursor
- id: IME-0004
  title: IME candidate window remains fixed during composition
  title-ja: IME変換候補ウィンドウが入力途中に移動しない
  category: input-method
  status: implemented
  tests:
  - client/e2e/core/ime-candidate-window-fixed-during-composition-90db08fa.spec.ts
  - client/e2e/core/ime-candidate-window-repositions-after-composition-end-1e01279f.spec.ts
  acceptance:
  - Hidden textarea position does not update between compositionstart and compositionend
- id: IMP-0001
  title: OPML/Markdown import and export
  title-ja: OPMLとMarkdownのインポートとエクスポート
  category: outline
  status: implemented
  components:
  - client/src/routes/[project]/settings/+page.svelte
  - client/src/services/importExportService.ts
  tests:
  - client/e2e/new/imp-opml-markdown-import-export-4b1c2f10.spec.ts
- id: IND-0001
  title: Advanced indentation and selection operations
  description: Use Tab and Shift+Tab to create nested structures and copy them via clipboard.
  category: editing
  status: implemented
  tests:
  - client/e2e/new/IND-0001.spec.ts
  - client/e2e/new/ind-indent-variations-1ef547d8.spec.ts
  acceptance:
  - Items can be indented with Tab to create nested structure
  - Items can be outdented with Shift+Tab
  - Selected nested items can be copied and pasted using clipboard
  title-ja: 高度なインデントと選択操作
- id: ITM-0001
  title: Add new items with Enter
  shortcut: Enter
  description: カーソル位置でアイテムを分割し、新しいアイテムを追加します。
  category: item-management
  status: implemented
  acceptance:
  - Enterキーを押すと、カーソル位置でアイテムが分割される
  - カーソルは新しいアイテムの先頭に移動する
  - カーソル位置より前のテキストは現在のアイテムに残る
  - カーソル位置より後のテキストは新しいアイテムに移動する
  - タイトルでは、新しいアイテムは最初の子として追加される
  - 通常のアイテムでは、新しいアイテムは兄弟として追加される
  tests:
  - client/e2e/core/itm-add-new-items-with-enter-49d26e99.spec.ts
  - client/e2e/core/itm-yjs-tree-reflects-split-42ac1ecd.spec.ts
  - client/src/tests/integration/itm-add-new-items-with-enter-49d26e99.integration.spec.ts
  title-ja: Enterで新規アイテム追加
- id: ITM-0002
  title: Add items with button
  description: Clicking the "アイテム追加" button adds a new outliner item.
  category: item-management
  status: implemented
  acceptance:
  - ボタンをクリックすると新しいアイテムがリストに表示される
  tests:
  - client/e2e/basic/itm-add-item-button-a4430f1e.spec.ts
  title-ja: ボタンでアイテム追加
- id: ITM-0003
  title: Delete empty items with Delete key
  description: Pressing Delete on an empty outliner item removes that item.
  category: item-management
  status: implemented
  acceptance:
  - アイテムが空の状態でDeleteキーを押すとそのアイテムが削除される
  - 削除後、カーソルは次のアイテムの先頭に移動する
  tests:
  - client/e2e/core/itm-delete-empty-item-9f4d79c4.spec.ts
  title-ja: Deleteキーで空のアイテムを削除
- id: ITM-00cbb408
  title: Drag items to reorder
  description: アイテムをドラッグ＆ドロップで並び替えできます。
  category: item-management
  status: implemented
  acceptance:
  - アイテムをドラッグ＆ドロップで移動できる
  tests:
  - client/e2e/core/itm-drag-items-to-reorder-00cbb408.spec.ts
  title-ja: ドラッグでアイテムを移動
- id: ITM-auto-add-sibling-item-on-edit-84442697
  title: Auto-add sibling on editing last item
  description: When the last visible outliner item is edited, a new empty sibling is automatically appended.
  category: item-management
  status: implemented
  acceptance:
  - Editing the bottommost item creates a new empty item below it
  tests:
  - client/e2e/core/itm-auto-add-sibling-item-on-edit-84442697.spec.ts
  title-ja: 最下部編集時に自動で兄弟アイテムを追加
- id: ITM-ea76cd92
  title: Merge with previous item on Backspace at start
  description: Pressing Backspace at the beginning of an item joins it with the previous item and moves the cursor to the boundary.
  category: item-management
  status: implemented
  acceptance:
  - Backspaceキーをアイテムの先頭で押すと前のアイテムと結合する
  - カーソルは連結前のテキスト末尾に移動する
  - 連結されたテキストが正しく表示される
  tests:
  - client/e2e/core/itm-backspace-merge-previous-item-ea76cd92.spec.ts
  title-ja: Backspaceで前のアイテムと結合
- id: ITM-ff843c45
  title: Title and child align horizontally
  description: ページタイトルとその直下の子アイテムの表示位置は同じX座標になります。
  category: item-management
  status: implemented
  acceptance:
  - タイトルとその子アイテムのx座標が同じ
  tests:
  - client/e2e/core/itm-title-child-aligned-x-position-ff843c45.spec.ts
  title-ja: タイトルと子アイテムの水平位置を揃える
- id: ITM-multi-line-input-6dcdbeef
  title: Multi-line text input
  description: Users can create multiple items by typing text and pressing Enter.
  category: item-management
  status: implemented
  acceptance:
  - Backspaceキーで文字を削除後、再入力したテキストが表示される
  - Enterキーを押すたびに新しいアイテムが追加される
  - 入力したテキストはそのアイテムだけに表示される
  tests:
  - client/e2e/core/itm-multi-line-input-6dcdbeef.spec.ts
  title-ja: 複数行テキスト入力
- id: KBS-1a2b3c4d
  title: Box selection visual feedback removal
  title-ja: 矩形選択の視覚フィードバックが解除される
  description: When using box selection, temporary visual feedback is removed after a short delay.
  category: selection
  status: implemented
  components:
  - client/src/lib/KeyEventHandler.ts
  tests:
  - client/e2e/core/kbs-box-selection-visual-feedback-removal-1a2b3c4d.spec.ts
- id: LNK-0001
  title: URL generation function for internal links
  description: 内部リンクのURLが正しく生成される機能
  category: navigation
  status: implemented
  acceptance:
  - '[/project-name/page-name] 形式の内部リンクが /project-name/page-name のURLを生成する'
  - '[page-name] 形式の内部リンクが /page-name のURLを生成する'
  - 内部リンクのHTMLが正しく生成される
  - 内部リンクのURLが正しく生成される
  tests:
  - client/e2e/core/lnk-url-generation-function-for-internal-links-b840d2c4.spec.ts
  title-ja: 内部リンクのURL生成機能
- id: LNK-0002
  title: Internal link functionality verification
  description: 内部リンクが正しく機能することを確認する
  category: navigation
  status: implemented
  acceptance:
  - プロジェクト内部リンク（/project-name/page-name形式）のhref属性が正しく生成される
  - 内部リンクのhref属性が正しく生成される
  - 内部リンクのクラスとテキストが正しく設定される
  - 様々な形式の内部リンクが正しく生成される
  tests:
  - client/e2e/core/lnk-internal-link-basic-eb4d5867.spec.ts
  - client/e2e/core/lnk-internal-link-url-eb4d5867.spec.ts
  - client/e2e/core/lnk-project-internal-link-eb4d5867.spec.ts
  title-ja: 内部リンクの機能検証
- id: LNK-0003
  title: Internal link navigation feature
  description: 内部リンクをクリックして別のページに移動する機能
  category: navigation
  status: implemented
  acceptance:
  - URLを直接入力して内部リンク先のページにアクセスできる
  - プロジェクト内部リンクの形式が正しく生成される（[/project-name/page-name]形式）
  - プロジェクト内部リンクをクリックして遷移先のページ内容が正しく表示される
  - プロジェクト内部リンク（/project-name/page-name形式）をクリックすると対応するページに移動する
  - 内部リンクの形式が正しく生成される（[page-name]形式）
  - 内部リンクをクリックして遷移先のページ内容が正しく表示される
  - 内部リンクをクリックすると対応するページに移動する
  - 存在しないページへのリンクをクリックした場合も対応するURLに移動する
  - 存在しないページへの内部リンクをクリックした場合、新規ページが作成される
  tests:
  - client/e2e/core/lnk-click-navigation-6feab1d7.spec.ts
  - client/e2e/core/lnk-create-internal-af8f309a.spec.ts
  - client/e2e/core/lnk-create-project-link-439b72bd.spec.ts
  - client/e2e/core/lnk-link-click-67f5c9da.spec.ts
  - client/e2e/core/lnk-nonexistent-link-f9a15261.spec.ts
  - client/e2e/core/lnk-project-link-navigation-e9b58abb.spec.ts
  - client/e2e/core/lnk-url-direct-df445603.spec.ts
  testcases:
  - 内部リンクをクリックして別のページに移動する
  - URLを直接入力して内部リンク先のページにアクセスする
  - 実際のアプリケーションで内部リンクを作成する
  - 実際のアプリケーションでプロジェクト内部リンクを作成する
  - 内部リンクをクリックして遷移先のページ内容が正しく表示される
  - 存在しないページへの内部リンクをクリックした場合の挙動
  - プロジェクト内部リンクをクリックして遷移先のページ内容が正しく表示される
  title-ja: 内部リンクのナビゲーション機能
- id: LNK-0004
  title: Temporary page function
  description: 存在しないページへのリンクをクリックした場合に仮ページを表示し、編集時のみ実際のページとして保存する機能
  category: navigation
  status: implemented
  acceptance:
  - 仮ページが保存された後は、通常のページとして扱われる
  - 仮ページであることを示すUIは表示されない（非表示設定）
  - 仮ページにアクセスしただけでは、ページは作成されない
  - 仮ページの通知UIは非表示になっている
  - 仮ページを編集した場合のみ、実際のページとして保存される
  - 存在しないページへのリンクをクリックした場合、仮ページを表示する
  tests:
  - client/e2e/core/lnk-temporary-page-display-08bbbbfc.spec.ts
  - client/e2e/core/lnk-temporary-page-edit-save-08bbbbfc.spec.ts
  - client/e2e/core/lnk-temporary-page-no-create-08bbbbfc.spec.ts
  - client/e2e/core/lnk-temporary-page-notice-buttons-08bbbbfc.spec.ts
  - client/e2e/core/lnk-temporary-page-notice-hidden-08bbbbfc.spec.ts
  testcases:
  - 存在しないページへのリンクをクリックした場合に仮ページが表示される
  - 仮ページを編集した場合に実際のページとして保存される
  - 仮ページにアクセスしただけではページが作成されないことを確認
  - 仮ページの通知UIが非表示になっている
  title-ja: 仮ページ機能
- id: LNK-0007
  title: Backlink function
  description: あるページからリンクされているページの一覧を表示する機能
  category: navigation
  status: implemented
  acceptance:
  - バックリンクのコンテキスト（リンクを含む文脈）が表示される
  - バックリンクの数がバッジとして表示される
  - バックリンクをクリックすると、リンク元のページに移動できる
  - バックリンクパネルには、そのページへのリンクを含むページの一覧が表示される
  - バックリンクパネルは開閉できる
  - ページにバックリンクパネルが表示される
  tests:
  - client/e2e/core/lnk-backlink-function-7976aef8.spec.ts
  testcases:
  - ページにバックリンクパネルが表示される
  - バックリンクパネルにリンク元ページの一覧が表示される
  - バックリンクの数がバッジとして表示される
  - バックリンクパネルを開閉できる
  - バックリンクをクリックするとリンク元ページに移動できる
  notes:
  - テスト環境ではバックリンクパネルの開閉が正確に動作しない場合があるため、TestHelpers.openBacklinkPanel()を使用してテストを安定化
  title-ja: バックリンク機能
- id: LNK-9a2f4dce
  title: External link navigation
  title-ja: 外部リンクナビゲーション
  description: Bracketed URLs open the target URL instead of entering edit mode.
  category: navigation
  status: implemented
  acceptance:
  - Clicking a bracketed URL opens the external site in a new tab.
  tests:
  - client/e2e/core/lnk-external-link-navigation-9a2f4dce.spec.ts
- id: LNK-9bddc693
  title: Link preview feature
  description: 内部リンクにマウスオーバーした際にページ内容のプレビューを表示する機能
  category: navigation
  status: implemented
  acceptance:
  - プレビューにはページのタイトルと内容の一部が表示される
  - プレビューはマウスが離れると非表示になる
  - 内部リンクにマウスオーバーするとプレビューが表示される
  - 別プロジェクトのページへのリンクの場合は、その旨が表示される
  - 存在しないページへのリンクの場合は、その旨が表示される
  tests:
  - client/e2e/core/lnk-link-preview-feature-9bddc693.spec.ts
  testcases:
  - 内部リンクにマウスオーバーするとプレビューが表示される
  - プレビューにページのタイトルと内容の一部が表示される
  - プレビューはマウスが離れると非表示になる
  - 存在しないページへのリンクの場合は、その旨が表示される
  notes:
  - テスト環境ではマウスイベントが正確に動作しない場合があるため、TestHelpers.forceHoverEvent()とTestHelpers.forceLinkPreview()を使用してテストを安定化
  title-ja: リンクプレビュー機能
- id: LOG-0001
  title: Development log service
  title-ja: 開発ログサービス
  description: Node server used in development and test environments to store logs. Firebase emulator initialization is handled by a separate script.
  category: api-server
  status: implemented
  components:
  - server/log-service.js
  - server/scripts/init-firebase-emulator.js
  tests:
  - client/e2e/core/log-development-log-service-8f761bd4.spec.ts
- id: LOG-6f1a5793
  title: Log rotation endpoint
  title-ja: ログローテーションエンドポイント
  description: POST /api/rotate-logs rotates client, telemetry, and server logs.
  category: api-server
  status: implemented
  components:
  - server/log-service.js
  - server/utils/logger.js
  tests:
  - client/e2e/core/log-rotate-log-files-endpoint-6f1a5793.spec.ts
  - server/tests/logger-rotate-logfile.test.js
  - server/tests/rotate-logs-endpoint.test.js
- id: MCE-0002
  title: VS Code style multi-cursor commands
  title-ja: VS Codeスタイルのマルチカーソルコマンド
  description: カーソル追加と取り消しをキーボードショートカットで行える
  category: editing
  status: implemented
  acceptance:
  - Ctrl+Shift+Alt+ArrowDown で下の行にカーソルを追加できる
  - Ctrl+Shift+Alt+ArrowUp で上の行にカーソルを追加できる
  - Ctrl+U で最後に追加したカーソルを取り消せる
  tests:
  - client/e2e/new/mce-multi-cursor-commands-655d1ca2.spec.ts
  - client/src/stores/EditorOverlayStore.test.ts
- id: MCE-37b78b62
  title: Multi-Cursor Editing
  description: 複数のカーソルを使って同時に編集できる機能
  category: collaboration
  status: implemented
  acceptance:
  - Undo/redoがすべてのカーソルに適用される
  - 各カーソルから独立してテキスト編集できる
  - 複数のカーソルを配置できる
  tests:
  - client/e2e/core/mce-multi-cursor-editing-37b78b62.spec.ts
  - client/src/stores/EditorOverlayStore.test.ts
  title-ja: マルチカーサーの編集
- id: MOB-0003
  title: Mobile Bottom Action Toolbar
  title-ja: モバイルアクションツールバー
  category: mobile
  status: implemented
  components:
  - client/src/components/MobileActionToolbar.svelte
  - client/src/routes/+layout.svelte
  tests:
  - client/e2e/core/MOB-0003.spec.ts
  acceptance:
  - Buttons scroll horizontally when overflowed
  - Indent and Outdent buttons modify item depth
  - Insert Above and Insert Below add sibling items
  - New Child creates a child under current item
  - Toolbar visible only on screens ≤ 768 px
- id: NAV-0001
  title: Project Selection and Page Navigation
  description: ルートページでプロジェクトを選択した場合にプロジェクトページへ遷移し、プロジェクトページからページリストを通じて個別ページへ遷移する機能
  category: navigation
  status: implemented
  acceptance:
  - プロジェクトページ(/[project_name])のページリストから、対応するページ(/[project_name]/[page_name])へ遷移するリンクが機能する
  - プロジェクト選択後、プロジェクト内のページ一覧が表示される
  - ページリストの各ページ名をクリックすると、そのページの内容が表示される
  - ルートページ(/)でプロジェクトを選択すると、対応するプロジェクトページ(/[project_name])へ遷移する
  tests:
  - client/e2e/core/nav-project-selection-and-page-navigation-bf35d422.spec.ts
  title-ja: プロジェクト選択とページナビゲーション
- id: NAV-0002
  title: Link function to project page
  description: ページ表示時にプロジェクトページへのリンクをパンくずナビゲーションとして表示する機能
  category: navigation
  status: implemented
  acceptance:
  - パンくずナビゲーションにプロジェクトページへのリンクが表示される
  - パンくずナビゲーションにホームへのリンクが表示される
  - パンくずナビゲーションに現在のページ名が表示される
  - プロジェクトページへのリンクをクリックするとプロジェクトページに遷移する
  - ページ表示時にパンくずナビゲーションが表示される
  - ホームへのリンクをクリックするとホームページに遷移する
  tests:
  - client/e2e/core/nav-link-function-to-project-page-a0e7d28a.spec.ts
  title-ja: プロジェクトページへのリンク機能
- id: NAV-7a3c91e2
  title: Consolidate currentPage responsibility into +page.svelte
  title-ja: currentPage 設定の責務を +page.svelte に集約
  category: navigation
  status: implemented
  description: '+layout.svelte と +page.svelte の両方に存在していた currentPage 設定処理を整理し、

    currentPage の決定・フォールバックは +page.svelte に集約。再入・二重待機と重複設定を解消して

    ルーティングの安定性とテストの堅牢性を高めた。

    '
  acceptance:
  - E2E テスト実行時、必要に応じて（テスト環境のみ）最小限のページ自動作成で安定化する
  - URL パラメータ変更時に該当ページが存在すれば currentPage がそのページに設定される
  - currentPage の設定は +page.svelte のみが行う（+layout.svelte は行わない）
  - サブテストにて OutlinerBase アンカーとメインツールバーの可視性を保証する
  - 既存のナビゲーション系E2E（LNK-0003 等）がグリーンである
  components:
  - client/src/routes/[project]/[page]/+layout.svelte
  - client/src/routes/[project]/[page]/+page.svelte
  notes:
  - E2E 環境では localStorage/env フラグにより Yjs WebSocket 接続を抑止し、404 ログノイズを防止済み
  - outliner-base の最小可視化チェックをサブテストで保証
  tests:
  - client/e2e/core/lnk-url-direct-df445603.spec.ts
  - client/e2e/core/nav-link-function-to-project-page-a0e7d28a.spec.ts
  - client/e2e/core/nav-outlinerbase-min-visibility-7a3c91e2.spec.ts
- id: OUT-3f2d8a9c
  title: Outline page is displayed after environment setup
  description: Ensure that TestHelpers.prepareTestEnvironment navigates to the new project page and displays the outline view.
  category: core
  status: implemented
  acceptance:
  - Breadcrumb shows project and page names
  - Consecutive Enter keys append additional outliner items
  - Enter creates a new outliner item
  - First outliner item accepts text input
  - Outliner items are rendered
  - OutlinerBase element becomes visible
  - Toolbar search box is displayed
  - prepareTestEnvironment navigates to the created project page
  tests:
  - client/e2e/core/out-outline-page-visible-3f2d8a9c.spec.ts
  title-ja: テスト環境準備後にアウトラインページが表示される
- id: PRJ-1a2b3c4d
  title: Rename Project
  title-ja: プロジェクト名の変更
  description: Allows users to rename their projects.
  user_story: As a user, I want to be able to rename my projects so I can better organize my work.
  acceptance_criteria:
  - Users can change the title of a project.
  - The project's URL slug does not change.
  - The new title is reflected in the project list and on the project page.
  category: project-management
  status: implemented
- id: PRJ-2b3c4d5e
  title: Delete and Restore Project
  title-ja: プロジェクトの削除と復元
  description: Allows users to delete and restore their projects.
  user_story: As a user, I want to be able to delete projects I no longer need and restore them if I make a mistake.
  acceptance_criteria:
  - Users can move a project to the trash.
  - Trashed projects can be restored.
  - Trashed projects can be permanently deleted.
  category: project-management
  status: implemented
- id: PRJ-3c4d5e6f
  title: Project Access Control
  title-ja: プロジェクトのアクセス制御
  description: Allows project owners to manage user permissions.
  user_story: As a project owner, I want to control who can view and edit my projects.
  acceptance_criteria:
  - Project owners can invite users to a project.
  - Project owners can set permissions for each user (e.g., read-only, read-write).
  - Users can only perform actions that are allowed by their permissions.
  category: project-management
  status: implemented
- id: PRJ-4d5e6f7a
  title: Public Project Sharing
  title-ja: プロジェクトの公開共有
  description: Allows users to share their projects publicly.
  user_story: As a user, I want to be able to share a read-only version of my project with anyone via a public link.
  acceptance_criteria:
  - Users can enable or disable public sharing for a project.
  - When public sharing is enabled, a unique, read-only link is generated.
  - Anyone with the link can view the project, but they cannot edit it.
  category: project-management
  status: implemented
- id: PRJ-5e6f7a8b
  title: Project Management UI
  title-ja: プロジェクト管理UI
  description: Provides a user interface for managing projects.
  user_story: As a user, I want a clear and intuitive interface to manage my projects, including renaming, deleting, and managing access.
  acceptance_criteria:
  - A dedicated project management page is available.
  - The page lists all projects the user has access to.
  - The UI provides options for renaming, deleting, and managing permissions for each project.
  category: project-management
  status: implemented
- id: PRS-0001
  title: Show real-time presence indicators
  title-ja: リアルタイムプレゼンス表示
  category: collaboration
  description: Display active users with colored avatars using Fluid presence data.
  status: implemented
  acceptance:
  - Avatars appear for all connected users
  - Colors remain consistent per user
  - Presence updates when users join or leave
  tests:
  - client/e2e/new/prs-real-time-presence-indicators-7b6a1ea8.spec.ts
  - client/src/tests/fluidPresence.test.ts
  - client/src/tests/integration/yjs/prs-real-time-presence-indicators-7b6a1ea8.integration.spec.ts
  - client/src/tests/presenceStore.test.ts
- id: PRS-4d2e1b6a
  title: Yjs cursor presence sync
  title-ja: Yjsカーソルプレゼンス同期
  description: Sync cursors via Yjs awareness and show remote avatars.
  category: yjs
  status: experimental
  tests:
  - client/e2e/new/prs-cursor-sync-4d2e1b6a.spec.ts
  - client/src/tests/integration/yjs/prs-cursor-sync-4d2e1b6a.integration.spec.ts
- id: PRS-b13f9c1a
  title: Cursor sync between tabs
  title-ja: タブ間のカーソル同期
  status: proposed
  tests:
  - client/e2e/basic/prs-cursor-sync-between-tabs-b13f9c1a.spec.ts
- id: RCT-0001
  title: Counter increments and decrements
  title-ja: カウンターの増減
  description: Demonstrates Svelte 5 runes reactivity with a simple counter component.
  category: example
  status: implemented
  components:
  - client/src/routes/counter/+page.svelte
  - client/src/tests/fixtures/Counter.svelte
  tests:
  - client/e2e/basic/rct-counter-increment-decrement-abc1def2.spec.ts
  - client/src/tests/integration/rct-counter-increment-decrement-abc1def2.integration.spec.ts
- id: SBD-ebaa03c1
  title: Show search dropdown only on focus
  title-ja: フォーカス時のみ検索候補を表示
  description: The page title search dropdown menu appears only while the search box is focused.
  category: navigation
  status: implemented
  components:
  - client/src/components/SearchBox.svelte
  - client/src/components/Toolbar.svelte
  tests:
  - client/e2e/core/sbd-search-dropdown-focus-116cc703-d78d-4b4d-9e89-bdd868061898.spec.ts
- id: SCH-43BB575F
  title: Schedule Management API Documentation
  description: README describes schedule management endpoints and example usage.
  category: publishing
  status: implemented
  acceptance:
  - README lists /api/create-schedule, /api/update-schedule, /api/list-schedules and /api/cancel-schedule
  - README shows sample curl requests for creating and cancelling schedules
  components:
  - functions/README.md
  - functions/index.js
  tests:
  - functions/test/schedule-management.test.js
  - functions/test/scheduled-publishing.test.js
  title-ja: スケジュール管理APIのドキュメント
- id: SCH-5A1C2B3D
  title: Schedule iCal Export
  title-ja: スケジュールのiCalエクスポート
  description: 'Users can download upcoming publishing schedules as an iCal (.ics) calendar containing strategy metadata and run times for external calendar tracking.

    '
  category: publishing
  status: implemented
  components:
  - client/src/routes/[project]/[page]/schedule/+page.svelte
  - client/src/services/scheduleService.ts
  - firebase.json
  - functions/ical.js
  - functions/index.js
  tests:
  - client/e2e/core/sch-export-ics-5a1c2b3d.spec.ts
  - functions/test/ical.test.js
  - functions/test/scheduled-publishing.test.js
- id: SCH-6974F589
  title: Schedule Management Page
  description: Provides a UI for listing and canceling scheduled publishing tasks.
  category: publishing
  status: implemented
  components:
  - client/e2e/core/sch-schedule-management-ui-6974f589.spec.ts
  - functions/test/schedule-management.test.js
  tests:
  - client/e2e/core/sch-schedule-management-ui-6974f589.spec.ts
  - functions/test/schedule-management.test.js
  title-ja: スケジュール管理ページ
- id: SCH-9E449EE3
  title: Schedule Management UI
  title-ja: スケジュール管理UI
  description: Users can view scheduled publishing tasks for a page.
  category: publishing
  status: implemented
  components:
  - client/e2e/core/sch-schedule-management-9e449ee3.spec.ts
  - client/src/routes/schedule/+page.svelte
  - functions/index.js
  tests:
  - client/e2e/core/sch-schedule-management-9e449ee3.spec.ts
- id: SCH-BA83FD47
  title: Scheduled Page Publishing
  description: Users can schedule pages for automatic publishing using Cloud Tasks.
  category: publishing
  status: implemented
  acceptance:
  - One-shot, delay, recurring, and debounced scheduling strategies are supported
  - Publishing tasks run server-side via Cloud Functions
  - Schedule creation verifies Firebase auth tokens
  - Schedules are stored per-page and scoped by user
  - Users can inspect and cancel their own schedules via API
  components:
  - client/e2e/core/sch-scheduled-page-publishing-ba83fd47.spec.ts
  - functions/index.js
  - functions/test/scheduled-publishing.test.js
  tests:
  - client/e2e/core/sch-scheduled-page-publishing-ba83fd47.spec.ts
  - functions/test/scheduled-publishing.test.js
  title-ja: 予約ページ公開
- id: SCH-C10DEA72
  title: Schedule List Refresh
  description: Clients can retrieve an updated list of schedules via the API.
  category: publishing
  status: implemented
  acceptance:
  - Invalid auth tokens return errors
  - List endpoint returns schedules ordered by nextRunAt
  components:
  - client/e2e/core/sch-list-schedules-c10dea72.spec.ts
  - functions/index.js
  tests:
  - client/e2e/core/sch-list-schedules-c10dea72.spec.ts
  - functions/test/scheduled-publishing.test.js
  title-ja: スケジュール一覧更新
- id: SCH-CFE72703
  title: Scheduled Posting Management UI
  description: Users can manage scheduled page posts via a dedicated interface.
  category: publishing
  status: implemented
  acceptance:
  - Users can create a new schedule specifying publish time and strategy
  - Users can edit or cancel schedules from this screen
  - Users can open a schedule management screen from the page menu
  - Users can view a list of existing schedules for the current page
  components:
  - client/e2e/core/sch-schedule-management-ui-cfe72703.spec.ts
  - client/src/routes/[project]/[page]/schedule/+page.svelte
  - client/src/services/scheduleService.ts
  - client/src/tests/scheduleService.test.ts
  - functions/index.js
  - functions/test/schedule-management.test.js
  tests:
  - client/e2e/core/sch-schedule-management-ui-cfe72703.spec.ts
  - client/src/tests/scheduleService.test.ts
  - functions/test/schedule-management.test.js
  title-ja: 予約投稿管理UI
- id: SCH-D83E13D7
  title: Schedule Editing
  description: Users can modify existing schedules via the API.
  category: publishing
  status: implemented
  acceptance:
  - Invalid or missing parameters return errors
  - Schedule updates require a valid Firebase auth token
  components:
  - client/e2e/core/sch-edit-schedule-d83e13d7.spec.ts
  - functions/index.js
  tests:
  - client/e2e/core/sch-edit-schedule-d83e13d7.spec.ts
  - functions/test/scheduled-publishing.test.js
  title-ja: スケジュール編集
- id: SCH-DF38D2F7
  title: Multi-Page Schedule Management
  title-ja: 複数ページのスケジュール管理
  description: 'E2E tests verify schedule creation, editing via the updateSchedule API,

    cancellation, and list refresh across multiple pages.'
  category: publishing
  status: implemented
  components:
  - client/e2e/core/sch-multi-page-schedule-management-df38d2f7.spec.ts
  - client/src/routes/[project]/[page]/schedule/+page.svelte
  - client/src/services/scheduleService.ts
  - client/src/tests/scheduleService.test.ts
  - functions/index.js
  - functions/test/scheduled-publishing.test.js
  tests:
  - client/e2e/core/sch-multi-page-schedule-management-df38d2f7.spec.ts
- id: SEA-0001
  title: Add page title search box
  title-ja: プロジェクトページ横断検索ボックスの追加
  description: A Scrapbox-like search box to find page titles within a project.
  category: navigation
  status: implemented
  components:
  - client/src/components/SearchBox.svelte
  - client/src/routes/[project]/+layout.svelte
  - client/src/routes/[project]/[page]/+page.svelte
  - client/src/stores/SearchHistoryStore.svelte.ts
  tests:
  - client/e2e/core/sea-page-title-search-box-a3674e4f-dce0-4543-9e85-1f1899f97f73.spec.ts
  - client/e2e/core/sea-page-title-search-box-active-project-7c4d92f1.spec.ts
  - client/src/tests/integration/sea-page-title-search-box-a3674e4f-dce0-4543-9e85-1f1899f97f73.integration.spec.ts
- id: SEC-0001
  title: Dotenvx encrypted env files
  description: Use dotenvx to encrypt server environment files
  category: security
  status: implemented
  components: []
  tests:
  - client/e2e/core/sec-dotenvx-encrypted-env-files-fa94885c.spec.ts
  title-ja: dotenvx暗号化されたenvファイル
- id: SEC-0002
  title: Two-Factor Authentication (2FA)
  description: This project intentionally omits two-factor authentication. Firebase Authentication handles user sign-in, and email link authentication is used only during testing.
  category: security
  status: deprecated
  components: []
  tests: []
  title-ja: 二因子認証（2FA）
- id: SLR-0001
  title: Shift + Up, down, left, right
  shortcut: Shift + 上下左右
  description: カーソルを1文字上下左右に移動し、選択範囲を広げます。
  category: selection-range
  status: implemented
  acceptance:
  - Shift + 上で選択範囲の上端を広げる
  - Shift + 下で選択範囲の下端を広げる
  - Shift + 右で選択範囲の右端を広げる
  - Shift + 左で選択範囲の左端を広げる
  tests:
  - client/e2e/core/slr-shift-up-down-left-right-eb1d392a.spec.ts
  title-ja: Shift + 上下左右
- id: SLR-0002
  title: Select up to the beginning of the line
  shortcut: Shift + Home
  description: カーソル位置から行の先頭までを選択します。
  category: selection-range
  status: implemented
  acceptance:
  - Shift + Homeで現在位置から行頭までを選択する
  - 複数行のアイテムでは、現在のカーソルがある行の先頭までを選択する
  tests:
  - client/e2e/core/slr-select-up-to-the-beginning-of-the-line-6c287e80.spec.ts
  title-ja: 行頭まで選択
- id: SLR-0003
  title: Select to the end of the line
  shortcut: Shift + End
  description: カーソル位置から行の末尾までを選択します。
  category: selection-range
  status: implemented
  acceptance:
  - Shift + Endで現在位置から行末までを選択する
  - 複数行のアイテムでは、現在のカーソルがある行の末尾までを選択する
  tests:
  - client/e2e/core/slr-select-to-the-end-of-the-line-8467ba25.spec.ts
  title-ja: 行末まで選択
- id: SLR-0004
  title: Selection by dragging mouse
  description: マウスドラッグでテキストを選択します。
  category: selection-range
  status: implemented
  acceptance:
  - マウスドラッグで単一アイテム内のテキストを選択できる
  - 選択範囲が視覚的に表示される
  - 選択範囲のテキストをコピーできる
  tests:
  - client/e2e/core/slr-selection-by-dragging-mouse-c032a81b.spec.ts
  title-ja: マウスドラッグによる選択
- id: SLR-0005
  title: Selection spans multiple items
  description: 複数アイテムにまたがるテキスト選択機能
  category: selection-range
  status: implemented
  acceptance:
  - Shift+上下キーで複数アイテムにまたがる選択範囲を作成できる
  - マウスドラッグで複数アイテムにまたがる選択範囲を作成できる
  - 複数アイテムにまたがる選択範囲が視覚的に表示される
  tests:
  - client/e2e/core/slr-selection-spans-multiple-items-7374d150.spec.ts
  title-ja: 複数アイテムにまたがる選択
- id: SLR-0006
  title: Copy and paste multiple item selection ranges
  description: 複数アイテムにまたがる選択範囲のコピー＆ペースト機能
  category: selection-range
  status: implemented
  acceptance:
  - コピーしたテキストを別の場所にペーストできる
  - 複数アイテムにまたがる選択範囲のテキストをコピーできる
  - 複数行テキストをペーストすると適切に複数アイテムに分割される
  tests:
  - client/e2e/core/slr-copy-selection-4c4c4f1a.spec.ts
  - client/e2e/core/slr-paste-copied-text-20a382d6.spec.ts
  - client/e2e/core/slr-paste-multiline-f8740117.spec.ts
  title-ja: 複数アイテム選択範囲のコピー＆ペースト
- id: SLR-0007
  title: Delete a multi-item selection
  description: 複数アイテムにまたがる選択範囲の削除機能
  category: selection-range
  status: implemented
  acceptance:
  - カーソル位置が適切に更新される
  - 削除後、アイテムが適切に結合される
  - 複数アイテムにまたがる選択範囲をBackspace/Deleteキーで削除できる
  tests:
  - client/e2e/core/slr-delete-a-multi-item-selection-9d60773c.spec.ts
  title-ja: 複数アイテム選択範囲の削除
- id: SLR-0008
  title: Selected Edge Case
  description: 選択範囲機能のエッジケースのテスト
  category: selection-range
  status: implemented
  acceptance:
  - 空のアイテムを含む選択範囲を作成できる
  - 複数アイテムにまたがる選択範囲を削除した後、カーソル位置が適切に更新される
  - 選択範囲の方向（正方向/逆方向）を切り替えることができる
  - 長いテキストを含むアイテムの選択範囲を作成できる
  tests:
  - client/e2e/core/slr-selected-delete-correction-31fe9b27.spec.ts
  - client/e2e/core/slr-selected-direction-3724726f.spec.ts
  - client/e2e/core/slr-selected-empty-item-bb3a9bf4.spec.ts
  - client/e2e/core/slr-selected-long-text-356b853a.spec.ts
  title-ja: 選択範囲のエッジケース
- id: SLR-0009
  title: Drag and drop text movement
  description: 選択範囲のテキストをドラッグ＆ドロップで移動する機能
  category: selection-range
  status: implemented
  acceptance:
  - アイテム全体をドラッグ＆ドロップで移動できる
  - ドラッグ中に視覚的なフィードバックが表示される
  - ドロップ位置に応じて適切にテキストが挿入される
  - 単一アイテム内の選択範囲をドラッグ＆ドロップで移動できる
  - 複数アイテムにまたがる選択範囲をドラッグ＆ドロップで移動できる
  tests:
  - client/e2e/core/slr-drag-drop-item-e889233a.spec.ts
  - client/e2e/core/slr-drag-drop-selection-e889233a.spec.ts
  title-ja: ドラッグ＆ドロップによるテキスト移動
- id: SLR-0010
  title: Change the format of the selection
  description: 選択範囲のテキストのフォーマット（太字、斜体、下線、取り消し線、コード）を変更する機能
  category: selection-range
  status: implemented
  acceptance:
  - Scrapbox構文に準拠したフォーマットが適用される
  - キーボードショートカットでフォーマットを変更できる
  - コードフォーマット（`text`）を適用できる
  - 単一アイテム内の選択範囲のフォーマットを変更できる
  - 取り消し線フォーマット（[- text]）を適用できる
  - 同じフォーマットを再度適用すると、フォーマットが解除される
  - 太字フォーマット（[[text]]）を適用できる
  - 斜体フォーマット（[/ text]）を適用できる
  - 複数アイテムにまたがる選択範囲のフォーマットを変更できる
  tests:
  - client/e2e/core/slr-change-the-format-of-the-selection-880de1fa.spec.ts
  title-ja: 選択範囲のフォーマット変更
- id: SLR-0011
  title: Expand selection
  shortcut: Shift + Alt + Right
  description: Use Shift+Alt+Right to expand the current selection to the end of the line.
  category: selection-range
  status: implemented
  acceptance:
  - If no selection exists, selection starts from the cursor
  - Shift+Alt+Right expands the selection to the end of the line
  tests:
  - client/e2e/core/slr-expand-selection-7d15b501.spec.ts
  title-ja: 選択範囲の拡張
- id: SLR-0012
  title: Shrink selection
  shortcut: Shift + Alt + Left
  description: Use Shift+Alt+Left to shrink or clear the current selection.
  category: selection-range
  status: implemented
  acceptance:
  - No selection results in no change
  - Shift+Alt+Left clears the current selection and moves the cursor to the start
  tests:
  - client/e2e/core/slr-shrink-selection-99167b65.spec.ts
  title-ja: 選択範囲の縮小
- id: SLR-0013
  title: Select current line
  shortcut: Ctrl + L
  description: Use Ctrl+L to select the entire line containing the cursor.
  category: selection-range
  status: implemented
  acceptance:
  - Ctrl+L selects the full line where the cursor is located
  - The cursor moves to the end of the line after selection
  tests:
  - client/e2e/core/slr-select-line-7e40ab64.spec.ts
  title-ja: 現在行を選択
- id: SLR-0100
  title: Box Selection (Rectangle Selection) Function - Keyboard
  shortcut: Alt+Shift+矢印キー
  description: Alt+Shift+矢印キーによる矩形選択機能
  category: selection-range
  status: implemented
  acceptance:
  - Alt+Shift+矢印キーで矩形選択を開始できる
  - Escキーで矩形選択をキャンセルできる
  - 矩形選択の範囲が視覚的に表示される
  - 矩形選択の範囲を矢印キーで拡張できる
  - 矩形選択範囲にテキストをペーストできる
  - 矩形選択範囲のテキストをコピーできる
  - 複数アイテムにまたがる矩形選択を作成できる
  tests:
  - client/e2e/core/slr-box-selection-rectangle-selection-function-keyboard-50ee5e3d.spec.ts
  title-ja: ボックス選択（矩形選択）機能 - キーボード
- id: SLR-0101
  title: Box Selection (Rectangle Selection) Function - Mouse
  shortcut: Alt+Shift+ドラッグ
  description: Alt+Shift+マウスドラッグによる矩形選択機能
  category: selection-range
  status: implemented
  acceptance:
  - Alt+Shift+マウスドラッグで矩形選択を開始できる
  - 矩形選択の範囲がドラッグに合わせて拡張される
  - 矩形選択の範囲が視覚的に表示される
  - 矩形選択範囲にテキストをペーストできる
  - 矩形選択範囲のテキストをコピーできる
  - 矩形選択範囲のテキストを削除できる
  - 複数アイテムにまたがる矩形選択を作成できる
  tests:
  - client/e2e/core/slr-box-selection-rectangle-selection-function-mouse-ca340ca3.spec.ts
  title-ja: ボックス選択（矩形選択）機能 - マウス
- id: SLR-0102
  title: Box Selection Copy-Cancel-Paste Timing Regression Test
  shortcut: Alt+Shift+ドラッグ
  description: 矩形選択のコピー・キャンセル・ペーストのタイミング問題を検出する回帰テスト
  category: selection-range
  status: implemented
  acceptance:
  - Escキーで矩形選択をキャンセルできる（ペーストせずに）
  - キャンセル後に再度矩形選択を作成できる
  - タイミング問題による回帰が発生しない
  - ペーストされたテキストが最初にコピーしたテキストと一致する
  - 再度作成した矩形選択にペーストできる
  - 矩形選択でテキストをコピーできる
  tests:
  - client/e2e/core/slr-box-selection-copy-cancel-paste-timing-regression-9f2a1b3c.spec.ts
  title-ja: ボックス選択コピー・キャンセル・ペーストのタイミング回帰テスト
- id: SRE-001
  title: Advanced Search & Replace
  description: 正規表現や範囲指定に対応した検索・置換機能
  category: search
  status: implemented
  components:
  - client/src/components/SearchPanel.svelte
  - client/src/lib/search/index.ts
  - client/src/routes/[project]/[page]/+page.svelte
  tests:
  - client/e2e/new/SRE-001.spec.ts
  title-ja: 高度な検索と交換
- id: SRP-0001
  title: Project-Wide Search & Replace
  title-ja: プロジェクト全体の検索・置換
  description: 全ページを対象とした高速全文検索と一括置換機能
  category: search
  status: implemented
  components:
  - client/src/components/SearchPanel.svelte
  - client/src/lib/search/index.ts
  - client/src/lib/search/projectSearch.ts
  - client/src/routes/[project]/[page]/+page.svelte
  tests:
  - client/e2e/new/SRP-0001.spec.ts
- id: SRP-bb11cc22
  title: Project-Wide Search & Replace
  title-ja: ''
  status: experimental
  scope: client
  spec:
    goal:
    - Across multiple pages in a project, search for a term and replace it (first/all)
    ui:
    - Page header contains a visible search button (.search-btn)
    - Clicking the search button opens a search panel (.search-panel)
    - Search panel contains inputs: null
    behavior:
    - When the search panel is visible, entering a query highlights matches in the current view
    - Replace All applies changes across all pages within the project
  E2E:
    policy:
    - In E2E, use window.__FLUID_SERVICE__, window.__FLUID_STORE__, window.__USER_MANAGER__
    - Wait until generalStore.project and generalStore.pages are available (do not rely on pages.current early)
    - Avoid SSR during E2E; +layout.ts sets ssr=false
    preparation:
    - Create a new container via __FLUID_SERVICE__.createNewContainer(projectTitle)
    - Ensure at least one page exists (client.createPage(pageName, lines))
    - Reflect the client to the app by setting __FLUID_STORE__.fluidClient = client
    navigation:
    - Use Svelte-managed navigation or page.goto to reach /:project/:page
    waits:
    - OutlinerBase [data-testid=outliner-base] exists
    - generalStore.project exists
    - generalStore.pages exists (no access to pages.current required)
    notes:
    - Items/Pages are ArrayLike; convert to arrays in tests before using filter/map (e.g., Array.from or by length/at)
  verification:
    minimal:
    - Search button exists and is clickable
    - Search panel becomes visible after clicking
    - Entering a query yields at least one match in realistic fixtures
- id: SRV-c4e1a2b3
  title: Yjs server accepts WebSocket connection
  title-ja: YjsサーバーがWebSocket接続を受け付ける
  category: server
  status: experimental
  components: []
  tests:
  - client/e2e/server/srv-yjs-server-connectivity-c4e1a2b3.spec.ts
- id: SRV-f8dc79a9
  title: WebSocket connection limits
  title-ja: WebSocket接続制限
  category: server
  status: experimental
  components:
  - server/src/server.ts
  tests:
  - client/e2e/server/srv-websocket-connection-limits-f8dc79a9.spec.ts
  - server/tests/connection-limits.test.js
  - server/tests/idle-timeout-reconnect.test.js
- id: TBL-0001
  title: Editable JOIN Table
  description: SQL query results editable via Fluid Framework and SQLite cache
  category: table
  status: implemented
  components:
  - src/components/ChartPanel.svelte
  - src/components/EditableQueryGrid.svelte
  - src/components/QueryEditor.svelte
  services:
  - src/services/sqlService.ts
  - src/services/editMapper.ts
  - src/services/syncWorker.ts
  tests:
  - client/e2e/new/TBL-0001.spec.ts
  - src/tests/editMapper.test.ts
  - src/tests/sqlService.test.ts
  - src/tests/syncWorker.test.ts
  acceptance:
  - JOINクエリで編集した値が正しいテーブルに反映される
  - PKエイリアスを利用してJOIN結果の各行が編集対象テーブルに正しくマッピングされる
  - SQLクエリ結果をグリッド表示する
  - クエリ実行後、ChartPanelが表示される
  - セル編集後、ChartPanelに変更が表示される
  - セル編集後、queryStoreのデータが更新される
  - セル編集後に再実行したクエリ結果も更新される
  - 編集内容がFluid経由で同期される
  - 編集後チャートが自動更新される
  title-ja: 編集可能な結合テーブル
- id: TBL-4f0d2b9a
  title: Table column and row manipulation
  description: Columns can be added via header context menu and reordered along with rows using drag and drop
  category: table
  status: implemented
  components:
  - src/components/EditableQueryGrid.svelte
  tests:
  - client/e2e/new/tbl-column-row-manipulation-4f0d2b9a.spec.ts
  acceptance:
  - Columns can be reordered by dragging headers
  - Right-clicking a header adds a new column after it
  - Rows can be reordered by dragging rows
  title-ja: テーブルのカラム・行操作
- id: THM-0001
  title: Dark mode theme toggle
  title-ja: ダークモードテーマの切り替え
  description: User can switch between light and dark themes.
  category: ui
  status: implemented
  tests:
  - client/e2e/core/thm-dark-mode-toggle-5e7cbe61.spec.ts
  acceptance:
  - アプリ全体でダークテーマとライトテーマを切り替えられる
- id: THM-0002
  title: Dark mode preference persists
  title-ja: ダークモード設定の保存
  category: ui
  description: Dark mode preference is saved and restored after page reload.
  status: implemented
  tests:
  - client/e2e/core/thm-dark-mode-persistence-0f7c39db.spec.ts
  acceptance:
  - ダークモード状態でリロードしてもダークモードが維持される
- id: TLB-5f79ac12
  title: Toolbar login status indicator
  title-ja: ツールバートップのログイン状態インジケーター
  description: Shows current authentication status on the global toolbar and highlights Google sign-ins with the official icon.
  category: auth
  status: implemented
  components:
  - client/src/components/LoginStatusIndicator.svelte
  - client/src/components/Toolbar.svelte
  services:
  - client/src/auth/UserManager.ts
  tests:
  - client/src/tests/integration/tlb-login-status-indicator-5f79ac12.integration.spec.ts
- id: TST-0001
  title: SharedTree Data Verification Utility
  description: テストにおいてSharedTreeの内容をJSONとして取得し、結果を厳密かつ簡易に判定するユーティリティ
  category: testing
  status: implemented
  acceptance:
  - SharedTreeのデータ構造をJSON形式で取得できる
  - スナップショットを取得して後で比較できる
  - ネストされた構造（親子関係）を正確に検証できる
  - 期待値と実際の値を厳密に比較できる
  - 期待値と実際の値を部分的に比較できる
  - 特定のパスのデータを検証できる
  - 特定のパスを無視して比較できる
  tests:
  - client/e2e/utils/tree-validation.spec.ts
  examples:
  - client/e2e/utils/tree-validator-examples.ts
  - client/e2e/utils/tree-validator-usage.md
  title-ja: SharedTreeデータ検証ユーティリティ
- id: TST-0002
  title: Cursor Information Verification Utility
  description: テストにおいてカーソル情報をJSONとして取得し、結果を厳密かつ簡易に判定するユーティリティ
  category: testing
  status: implemented
  acceptance:
  - アクティブなアイテムIDを検証できる
  - カーソルの数を検証できる
  - カーソル情報をJSON形式で取得できる
  - スナップショットを取得して後で比較できる
  - 期待値と実際の値を厳密に比較できる
  - 期待値と実際の値を部分的に比較できる
  - 特定のパスのデータを検証できる
  tests:
  - client/e2e/utils/cursor-validation.spec.ts
  examples:
  - client/e2e/utils/cursor-validator-examples.ts
  - client/e2e/utils/cursor-validator-usage.md
  title-ja: カーソル情報検証ユーティリティ
- id: TST-0003
  title: Test Helper Utility
  description: テストにおいてカーソル状態の検証を容易にするヘルパー関数群
  category: testing
  status: implemented
  acceptance:
  - DOM要素の可視性を強制的に確認できる（forceCheckVisibility）
  - class:editingセレクタの代わりにカーソル状態を検証できる
  - アイテムをクリックして編集モードに入れる（clickItemToEdit）
  - アクティブなアイテムIDを取得できる（getActiveItemId）
  - アクティブなアイテム要素を取得できる（getActiveItemLocator）
  - カーソルが表示されるまで待機できる（waitForCursorVisible）
  - カーソルデバッグ機能をセットアップできる（setupCursorDebugger）
  - バックリンクパネルを開くことができる（openBacklinkPanel）
  - マウスアウトイベントを強制的にシミュレートできる（forceMouseOutEvent）
  - マウスオーバーイベントを強制的にシミュレートできる（forceHoverEvent）
  - リンクプレビューを強制的に表示できる（forceLinkPreview）
  tests:
  - client/e2e/auth/auth.spec.ts
  - client/e2e/core/clm-click-to-enter-edit-mode-760e61d9.spec.ts
  - client/e2e/core/clm-cursor-duplication-and-input-distribution-problems-when-moving-between-items-be4c0ba6.spec.ts
  - client/e2e/core/clm-cursor-manipulation-with-format-strings-86f0d787.spec.ts
  - client/e2e/core/clm-go-to-the-beginning-of-the-line-d39d158b.spec.ts
  - client/e2e/core/clm-go-to-the-end-of-the-line-03dfa6ef.spec.ts
  - client/e2e/core/clm-move-down-4215682b.spec.ts
  - client/e2e/core/clm-move-left-b4e61244.spec.ts
  - client/e2e/core/clm-move-to-the-right-c4f91a56.spec.ts
  - client/e2e/core/clm-move-up-810ae124.spec.ts
  - client/e2e/core/clm-the-cursor-does-not-increase-when-normal-clicks-1ac82e88.spec.ts
  - client/e2e/core/fmt-consistency-of-format-display-when-moving-cursors-36199743.spec.ts
  - client/e2e/core/ime-japanese-input-using-ime-59109b4a.spec.ts
  - client/e2e/core/itm-add-new-items-with-enter-49d26e99.spec.ts
  - client/e2e/core/slr-change-the-format-of-the-selection-880de1fa.spec.ts
  - client/e2e/core/slr-select-to-the-end-of-the-line-8467ba25.spec.ts
  - client/e2e/core/slr-selection-by-dragging-mouse-c032a81b.spec.ts
  - client/e2e/core/slr-selection-spans-multiple-items-7374d150.spec.ts
  - client/e2e/core/tst-improve-your-test-environment-72a51b65.spec.ts
  examples:
  - client/e2e/utils/testHelpers.ts
  title-ja: テストヘルパーユーティリティ
- id: TST-0004
  title: Improve your test environment
  description: テスト環境の安定性と信頼性を向上させるための改善
  category: testing
  status: implemented
  acceptance:
  - DOM要素の検出と操作のためのヘルパー関数を提供する
  - テスト実行時のタイムアウト設定を延長し、テストの安定性を向上させる
  - テスト環境の制約を考慮したテスト条件の調整を行う
  - マウスイベントが正確に動作しない場合に代替手段を提供する
  - 要素の検出待機のタイムアウト設定を延長し、テストの安定性を向上させる
  tests:
  - client/e2e/core/lnk-backlink-function-7976aef8.spec.ts
  - client/e2e/core/tst-improve-your-test-environment-72a51b65.spec.ts
  notes:
  - テスト環境ではマウスイベントやDOM要素の検出が不安定な場合があるため、専用のヘルパー関数を使用してテストを安定化
  - headlessモードでの実行時に一部の機能が正常に動作しない場合があるため、代替手段を提供
  title-ja: テスト環境の改善
- id: TST-0005
  title: Initializing and preparing the test environment
  description: テスト実行前の環境準備を改善し、テストの安定性と再現性を向上させる
  category: testing
  status: implemented
  acceptance:
  - DOM要素の検出問題を解決するための改善されたヘルパー関数を提供する
  - UI操作ではなくFluid APIを使用して直接データを作成することで安定性を向上させる
  - テスト実行前にプロジェクトとページを自動的に作成する仕組みを提供する
  - テスト環境の初期化を一貫した方法で行うヘルパー関数を提供する
  - テスト間の依存関係を減らし、各テストが独立して実行できるようにする
  tests:
  - client/e2e/basic.spec.ts
  - client/e2e/helpers.ts
  - client/e2e/utils/linkTestHelpers.ts
  - client/e2e/utils/testHelpers.ts
  - client/src/tests/integration/homepage-auth.integration.spec.ts
  - client/src/tests/integration/tst-initializing-and-preparing-the-test-environment-b55298f7.integration.spec.ts
  notes:
  - テスト環境では要素の検出が不安定な場合があるため、再試行機能を持つヘルパー関数を使用してテストを安定化
  - テストデータの作成にはUI操作ではなくFluid APIを使用し、テストの安定性を向上
  - テスト前の環境準備を標準化することで、テスト間の依存関係を減少
  title-ja: テスト環境の初期化と準備
- id: TST-0012
  title: UserManager global access for tests
  category: testing
  status: implemented
  description: __USER_MANAGER__ is initialized before E2E tests so authentication helpers can interact with it.
  acceptance:
  - Auth E2E test uses programmatic login without context errors
  - Test helpers rely on __USER_MANAGER__ for programmatic login
  - Unit test verifies global variable presence
  - window.__USER_MANAGER__ is defined after app load
  tests:
  - client/e2e/auth/auth.spec.ts
  - client/src/tests/userManager-global.test.ts
  components:
  - client/e2e/utils/testHelpers.ts
  - client/src/auth/UserManager.ts
  title-ja: テスト用にUserManagerをグローバル公開
- id: TST-09c9de20
  title: Environment variable is loaded in browser
  title-ja: ブラウザで環境変数が読み込まれる
  category: testing
  description: Verify that VITE_IS_TEST from .env loads in the client runtime.
  status: implemented
  tests:
  - client/e2e/basic/tst-env-variable-check-09c9de20.spec.ts
  - client/src/tests/integration/tst-env-variable-check-09c9de20.integration.spec.ts
- id: TXT-8c8218a3
  title: Add text to new item
  title-ja: 新しいアイテムにテキストを追加
  description: Verify that creating an item and updating its text persists in the project tree.
  category: example
  status: implemented
  components:
  - client/src/components/OutlinerTree.svelte
  tests:
  - client/e2e/basic/add-text-functionality.spec.ts
  - client/src/tests/integration/add-text-functionality.integration.spec.ts
- id: USR-0661ecad
  title: Container removal function
  description: コンテナとそれに関連するデータを削除する機能
  category: container-management
  status: implemented
  acceptance:
  - コンテナがデフォルトコンテナだった場合、ユーザーのデフォルトコンテナが更新される
  - コンテナが存在しない場合は適切なエラーメッセージが表示される
  - コンテナにアクセス可能だったユーザーのアクセス権からコンテナIDが削除される
  - コンテナへのアクセス権がない場合は適切なエラーメッセージが表示される
  - コンテナを削除できる
  title-ja: コンテナ削除機能
- id: USR-baaa8b62
  title: User deletion function
  description: ユーザーアカウントとそれに関連するデータを削除する機能
  category: user-management
  status: implemented
  acceptance:
  - Firebase Authからユーザーアカウントが削除される
  - ユーザーがアクセス可能だったコンテナからユーザーIDが削除される
  - ユーザーが最後のアクセス者だったコンテナは完全に削除される
  - ユーザーに関連するコンテナ情報が削除される
  - ユーザーアカウントを削除できる
  title-ja: ユーザー削除機能
- id: YJS-a1b2c3d4
  title: Verify Yjs store connection
  title-ja: Yjsストア接続の確認
  category: data
  description: Ensure Yjs client connects and exposes connection state.
  status: experimental
  acceptance:
  - Connection state is accessible via __YJS_STORE__
  - Yjs store initializes after authentication
  tests:
  - client/e2e/new/yjs-basic-sync-a1b2c3d4.spec.ts
  - client/src/tests/integration/yjs/yjs-basic-sync-a1b2c3d4.integration.spec.ts
- id: YJS-c7f9e2a1
  title: Use yjsService in Outliner components
  title-ja: Outliner コンポーネントで yjsService を使用
  status: experimental
  spec: 'OutlinerTree, OutlinerItem, and Cursor remove fluidStore dependencies and rely on yjsService.

    User identity comes from UserManager.

    '
  tests:
  - client/src/tests/unit/cursor-is-page-item.spec.ts
- id: YJS-e1f2a3b4
  title: Yjs WebSocket sync basic
  title-ja: Yjs WebSocket同期の基本
  description: Verify that two browser contexts can connect to the same project and sync via WebSocket.
  category: data
  status: experimental
  acceptance:
  - Both contexts establish WebSocket connections
  - Two browser contexts connect to the same project ID
  - WebSocket sync completes successfully
  tests:
  - client/e2e/yjs/yjs-websocket-sync-basic-e1f2a3b4.spec.ts
- id: YJS-f2g3h4i5
  title: Yjs project data sync
  title-ja: Yjsプロジェクトデータ同期
  description: Verify that two browser contexts can connect to the same project and see the same project data.
  category: data
  status: experimental
  acceptance:
  - Both contexts see the same project title
  - Project data is synchronized between contexts
  - Two browser contexts connect to the same project ID
  tests:
  - client/e2e/yjs/yjs-project-sync-f2g3h4i5.spec.ts
- id: YJS-g3h4i5j6
  title: Yjs page data sync
  title-ja: Yjsページデータ同期
  description: Verify that two browser contexts can connect to the same page and see the same page data.
  category: data
  status: experimental
  acceptance:
  - Both contexts see the same number of items
  - Both contexts see the same page title
  - Page data is synchronized between contexts
  - Two browser contexts connect to the same page ID
  tests:
  - client/e2e/yjs/yjs-page-sync-g3h4i5j6.spec.ts
- id: YPP-c83a5f4b
  title: Page subdoc per-page provider
  description: Each project page uses a YJS subdocument connected to its own WebSocket room.
  category: yjs
  status: implemented
  acceptance:
  - Awareness updates are isolated per page
  - Opening two pages in the same project connects to different rooms
  tests:
  - client/e2e/yjs/ypp-page-subdoc-provider-c83a5f4b.spec.ts
  - client/src/tests/integration/yjs/ypp-page-subdoc-provider-c83a5f4b.integration.spec.ts
  title-ja: ページごとに独立したYJSサブドキュメントとプロバイダー
- id: YRR-b4e2c1d0
  title: YJS token refresh reconnect
  description: Ensures YJS connections refresh auth tokens and reconnect without manual reload.
  category: yjs
  status: implemented
  acceptance:
  - Room paths are generated consistently across client
  - Token expiry mid-session recovers without manual reload
  tests:
  - client/e2e/yjs/yrr-token-refresh-reconnect-b4e2c1d0.spec.ts
  - client/src/tests/integration/yjs/yrr-token-refresh-reconnect-b4e2c1d0.integration.spec.ts
  title-ja: YJSトークン更新後の自動再接続
