id: ENV-7f3a9c12
title: Optimize large bundle chunks via Vite manualChunks
description: Optimize large bundle chunks via Vite manualChunks. In response to build-time 500kB chunk size warnings, used Vite/Rollup manualChunks to split echarts (charts/components/core), zrender, and firebase. Separated major vendor dependencies without functional changes. Note that "Some chunks are larger than 500 kB" messages from Vite client build cannot be suppressed via Rollup onwarn and may persist, but are considered acceptable due to the nature of ECharts dependencies. Dynamic imports for further lazy loading will be considered in the future if necessary.
category: environment
status: implemented
components:
- client/src/components/ChartPanel.svelte
- client/src/routes/(app)/graph/+page.svelte
- client/src/routes/(app)/yjs-outliner/+page.svelte
- client/vite.config.ts
changes:
- Defined rollupOptions.output.manualChunks as a function in client/vite.config.ts to subdivide echarts into charts/components/core, and chunk zrender and firebase individually.
- Filtered CHUNK_SIZE_LIMIT via onwarn in the same file (Vite-side warnings may remain).
verification:
- Run npm run build and confirm vendor splitting is reflected.
- Run one basic E2E scenario in the affected area to ensure no regression.
notes:
- Vite size warnings are custom output during client build and cannot be disabled via Rollup onwarn.
- This measure is a first step to introduce vendor splitting with minimal changes. Screen-level dynamic import will be considered if necessary.
- Prioritized mitigation via splitting rather than manually raising chunkSizeWarningLimit.
- If screens using ECharts become heavy on initial load, code splitting per panel or route can be extended.
- Future splitting candidates: Lazy loading for graph features and editor auxiliary features.
tests:
- client/e2e/basic/00-tst-outliner-visible-after-prepare-0f1a2b3c.spec.ts
title-ja: Optimize large bundle chunks via Vite manualChunks
